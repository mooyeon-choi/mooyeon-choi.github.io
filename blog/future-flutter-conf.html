<!doctype html>
<html lang="ko" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">퓨처 플러터 컨퍼런스 톺아보기 | Mylog</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mooyeon-choi.github.io/blog/future-flutter-conf"><meta data-rh="true" property="og:locale" content="ko"><meta data-rh="true" name="docusaurus_locale" content="ko"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="ko"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="퓨처 플러터 컨퍼런스 톺아보기 | Mylog"><meta data-rh="true" name="description" content="소개"><meta data-rh="true" property="og:description" content="소개"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-10-29T12:47:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/mooyeon-choi"><meta data-rh="true" property="article:tag" content="Dart,Flutter,app"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://mooyeon-choi.github.io/blog/future-flutter-conf"><link data-rh="true" rel="alternate" href="https://mooyeon-choi.github.io/blog/future-flutter-conf" hreflang="ko"><link data-rh="true" rel="alternate" href="https://mooyeon-choi.github.io/blog/future-flutter-conf" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://mooyeon-choi.github.io/blog/future-flutter-conf","mainEntityOfPage":"https://mooyeon-choi.github.io/blog/future-flutter-conf","url":"https://mooyeon-choi.github.io/blog/future-flutter-conf","headline":"퓨처 플러터 컨퍼런스 톺아보기","name":"퓨처 플러터 컨퍼런스 톺아보기","description":"소개","datePublished":"2024-10-29T12:47:00.000Z","author":{"@type":"Person","name":"Mooyeon Choi","url":"https://github.com/mooyeon-choi","image":"https://github.com/mooyeon-choi.png"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://mooyeon-choi.github.io/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Mylog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Mylog Atom Feed">




<script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/5.1.3/pixi.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/webfont/1.6.28/webfontloader.js"></script><link rel="stylesheet" href="/assets/css/styles.e76434eb.css">
<script src="/assets/js/runtime~main.d427de84.js" defer="defer"></script>
<script src="/assets/js/main.65301e70.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="본문으로 건너뛰기"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">본문으로 건너뛰기</a></div><nav aria-label="메인" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="사이드바 펼치거나 접기" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Mylog</b></a><a class="navbar__item navbar__link" href="/docs/intro">개발 공부</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">기록</a><a class="navbar__item navbar__link" href="/showcase">Showcase</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://evanescent-table-194.notion.site/Frontend-0866085aac3c4c619efbd9ab1d940329" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Resume<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://open.kakao.com/o/sEenYDXg" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">CoffeeChat<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://github.com/mooyeon-choi" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="어두운 모드와 밝은 모드 전환하기 (현재 system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="최근 블로그 문서 둘러보기"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025-kwdc">2025 KWDC 톺아보기</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/feconf2025">FECONF2025 톺아보기</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/onnx-on-web">Onnx web runtime 구축하기 with Vite</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/eslint-with-tailwindcss">왜 eslint-plugin-tailwindcss 를 버리고 eslint-plugin-better-tailwindcss 를 새로 개발하였을까?</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/service-worker">Web Service Worker로 파일 업로드 분리하기</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">퓨처 플러터 컨퍼런스 톺아보기</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-10-29T12:47:00.000Z">2024년 10월 29일</time></div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/mooyeon-choi" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://github.com/mooyeon-choi.png" alt="Mooyeon Choi"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/mooyeon-choi" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Mooyeon Choi</span></a></div><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="소개">소개<a href="#소개" class="hash-link" aria-label="소개에 대한 직접 링크" title="소개에 대한 직접 링크">​</a></h2>
<p>조금 늦었지만, 2024년 9월 28일 진행된 Flutter 컨퍼런스 Future Flutter에서 들었던 내용을 정리하고, 실제 회사에 적용해보며 겪었던 이슈들에 대한 내용을 정리한 글이다.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>목차</div><div class="admonitionContent_BuS1"><ol>
<li><a href="#ffi%EB%A1%9C-%EC%97%B0%EA%B2%B0%ED%95%98%EB%8A%94-%EA%B3%A0go%EC%99%80-%ED%94%8C%EB%9F%AC%ED%84%B0">FFI로 연결하는 고(Go)와 플러터</a></li>
<li><a href="#flutter-webrtc">Flutter WebRTC</a></li>
<li><a href="#shorebird-%EC%9E%91%EB%8F%99-%EB%B0%A9%EC%8B%9D">ShoreBird 작동 방식</a></li>
<li><a href="#%ED%92%8D%EC%84%B1%ED%95%9C-%EB%94%94%EC%9E%90%EC%9D%B8-%EC%9A%94%EC%B2%AD%EC%82%AC%ED%95%AD%EC%97%90-%EB%8C%80%EC%9D%91%ED%95%98%EA%B8%B0">풍성한 디자인 요청사항에 대응하기</a></li>
<li><a href="#%ED%94%8C%EB%9F%AC%ED%84%B0-%EB%A0%8C%EB%8D%94%EB%A7%81-%ED%95%B4%EB%B6%80%ED%95%99">플러터 렌더링 해부학</a></li>
<li><a href="#flutter-web%EC%9D%84-%ED%99%9C%EC%9A%A9%ED%95%98%EC%97%AC-%EC%A0%9C%ED%92%88-%EA%B0%9C%EB%B0%9C-%ED%99%98%EA%B2%BD-%EA%B0%9C%EC%84%A0%ED%95%98%EA%B8%B0">Flutter web을 활용하여 제품 개발 환경 개선하기</a></li>
<li><a href="#%EC%96%B4%EB%8A%90%EB%82%A0-%EA%B0%91%EC%9E%90%EA%B8%B0-%EC%95%B1%EC%9D%B4-%ED%84%B0%EC%A1%8C%EC%9D%84-%EB%95%8C">어느날 갑자기 앱이 터졌을 때</a></li>
<li><a href="#flutter-bloc%EC%9D%84-%EC%A0%9C%ED%92%88-%EA%B0%9C%EB%B0%9C%EC%97%90-%EC%95%BC%EB%AC%B4%EC%A7%80%EA%B2%8C-%EC%A0%81%EC%9A%A9%ED%95%98%EA%B8%B0">Flutter Bloc을 제품 개발에 야무지게 적용하기</a></li>
</ol></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ffi로-연결하는-고go와-플러터">FFI로 연결하는 고(Go)와 플러터<a href="#ffi로-연결하는-고go와-플러터" class="hash-link" aria-label="FFI로 연결하는 고(Go)와 플러터에 대한 직접 링크" title="FFI로 연결하는 고(Go)와 플러터에 대한 직접 링크">​</a></h2>
<p>멀티 플랫폼에 대응하는 앱을 만들기 위해 Go 언어와 플러터를 활용하며 기본적인 UI 디자인을 적용하며 고성능의 앱을 개발하는 방법에 대해 고민하며 적용한 내용에 대한 발표였다.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="왜-go-인가">왜 Go 인가?<a href="#왜-go-인가" class="hash-link" aria-label="왜 Go 인가?에 대한 직접 링크" title="왜 Go 인가?에 대한 직접 링크">​</a></h3>
<p>고언어를 채택한 장점에는 크게 3가지의 이유가 있었다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="크로스-플랫폼-개발">크로스 플랫폼 개발<a href="#크로스-플랫폼-개발" class="hash-link" aria-label="크로스 플랫폼 개발에 대한 직접 링크" title="크로스 플랫폼 개발에 대한 직접 링크">​</a></h4>
<p>Windows, macOS, Linux 와 같은 다양한 운영체제와 x86, ARM 등의 아키텍쳐로 크로스 컴파일이 가능하여 보다 빠르게 다양한 플랫폼 지원을 간편하게 한다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="빠른-컴파일과-실행">빠른 컴파일과 실행<a href="#빠른-컴파일과-실행" class="hash-link" aria-label="빠른 컴파일과 실행에 대한 직접 링크" title="빠른 컴파일과 실행에 대한 직접 링크">​</a></h4>
<p>Go언어는 머신코드로 바로 컴파일 가능하기 때문에 고성능의 앱 개발에 유리하다. 실행속도가 빠를 뿐만아니라 컴파일 속도도 빨라, 수정사항을 빠르게 적용하여 테스트 가능하고 이로인해 개발 속도를 빠르게 가져갈 수 있다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="가벼움과-확장성">가벼움과 확장성<a href="#가벼움과-확장성" class="hash-link" aria-label="가벼움과 확장성에 대한 직접 링크" title="가벼움과 확장성에 대한 직접 링크">​</a></h4>
<p>고루틴과 채널이라 알려진 동시성 기능을 지원하여 많은 작업들을 성능저하 없이 동시에 처리 가능하다. 효율성과 확장성을 필요로하는 고성능 어플리케이션 개발에 이상적이다.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="왜-플러터인가">왜 플러터인가?<a href="#왜-플러터인가" class="hash-link" aria-label="왜 플러터인가?에 대한 직접 링크" title="왜 플러터인가?에 대한 직접 링크">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="크로스-플랫폼-개발-1">크로스 플랫폼 개발<a href="#크로스-플랫폼-개발-1" class="hash-link" aria-label="크로스 플랫폼 개발에 대한 직접 링크" title="크로스 플랫폼 개발에 대한 직접 링크">​</a></h4>
<p>하나의 코드 베이스로 안드로이드, IOS, Windows desktop, Web 등 여러 플랫폼 개발이 가능하다. 이로인해 적은 인원과 시간으로 다양한 플랫폼에 대응하는 App.을 개발할 수 있다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="유용한-개발도구">유용한 개발도구<a href="#유용한-개발도구" class="hash-link" aria-label="유용한 개발도구에 대한 직접 링크" title="유용한 개발도구에 대한 직접 링크">​</a></h4>
<p>플러터의 핫리로드, 핫리스타스 같은 기능과 유용한 개발 도구를 지원해 개발 속도를 빠르게 한다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="빠르고-아름다운-애플리케이션">빠르고 아름다운 애플리케이션<a href="#빠르고-아름다운-애플리케이션" class="hash-link" aria-label="빠르고 아름다운 애플리케이션에 대한 직접 링크" title="빠르고 아름다운 애플리케이션에 대한 직접 링크">​</a></h4>
<p>플러터는 자체적으로 기본적인 애니메이션과 인터렉션에 대한 처리가 되어있어 보다 간편하게 고퀄리티의 사용자 경험을 제공한다. 또한 각 플랫폼에 맞게 컴파일되어 효율적으로 동작하도록 해준다.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ffi-란">FFI 란?<a href="#ffi-란" class="hash-link" aria-label="FFI 란?에 대한 직접 링크" title="FFI 란?에 대한 직접 링크">​</a></h3>
<p>Foreign Function Interface (FFI)는 C언어로 짜여진 함수를 다트나 플러터에서 사용하는 방법으로 플러터에서는 <code>dart:ffi</code> 패키지를 사용한다.</p>
<p>C뿐만 아니라 Go, C++, Rust 등의 <strong>C 인터페이스 를 제공하는 언어</strong>라면 Dart에서 사용이 가능하다.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="플러터에서-ffi-사용하기">플러터에서 FFI 사용하기<a href="#플러터에서-ffi-사용하기" class="hash-link" aria-label="플러터에서 FFI 사용하기에 대한 직접 링크" title="플러터에서 FFI 사용하기에 대한 직접 링크">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">flutter create --platforms=android,ios,macos,windows,linux --template=plugin ffi native add</span><br></span></code></pre></div></div>
<p>위 커맨드로 프로젝트를 생성하면 <code>lib</code>폴더 아래에 <code>Dart</code> 코드, <code>src</code> 폴더 아래에 <code>C</code> 코드가 생성된다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="고언어-라이브러리-생성하기">고언어 라이브러리 생성하기<a href="#고언어-라이브러리-생성하기" class="hash-link" aria-label="고언어 라이브러리 생성하기에 대한 직접 링크" title="고언어 라이브러리 생성하기에 대한 직접 링크">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="고언어-코드-작성">고언어 코드 작성<a href="#고언어-코드-작성" class="hash-link" aria-label="고언어 코드 작성에 대한 직접 링크" title="고언어 코드 작성에 대한 직접 링크">​</a></h5>
<ol>
<li>
<p><code>src</code>폴더 안에 <code>go.mod</code> 파일 생성</p>
<blockquote>
<p><strong><code>go.mod</code> 파일이란?</strong> 모듈 이름, 버전, 의존성 등을 정의하는 파일</p>
</blockquote>
</li>
<li>
<p><code>sum.go</code> 파일을 생성하고 고언어 코드를 작성</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// sum.go file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;C&quot;</span><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// cgo 문법으로</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token comment" style="color:#999988;font-style:italic">// export &lt;함수명&gt; 주석을 이용해서 sum이라는 함수를 C로 export</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// export sum</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a C</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b C</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> C</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">int</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// C에서 사용해야하기 때문에 Go의</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> a </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> b                        </span><span class="token comment" style="color:#999988;font-style:italic">// 타입이 아닌 C 타입으로 C.int 를 사용</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="고언어-라이브러리를-안드로이드용으로-컴파일">고언어 라이브러리를 안드로이드용으로 컴파일<a href="#고언어-라이브러리를-안드로이드용으로-컴파일" class="hash-link" aria-label="고언어 라이브러리를 안드로이드용으로 컴파일에 대한 직접 링크" title="고언어 라이브러리를 안드로이드용으로 컴파일에 대한 직접 링크">​</a></h4>
<p>최신 안드로이드 단말기들을 지원하기 위해서는 <code>arm64</code>와 <code>x86_64</code> 아키텍처를 지원하도록 크로스 컴파일 되어야함</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">export ANDROID_OUT=../android/src/main/jniLibs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export ANDROID_SDK=$HOME/Library/Android/sdk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export NDK_BIN=$ANDROID_SDK/ndk/23.1.777.9620/toolchains/llvm/prebuilt/darwin-x86_64/bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># x86_64 아키텍처로 컴파일 해서 android/src/main/jniLibs/x86_64 폴더에 libsum.so 생성</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CGO_ENABLED=1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GOOS=android \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GOARCH=and64 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CC=$NDK_BIN/x86_64-linux-android21-clang \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">go build -buildmod=c-shared -o $ANDROID_OUT/x86_64/libsum.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># arm64 아키텍처로 컴파일 해서 android/src/main/jniLibs/arm64-v8a 폴더에 libsum.so 생성</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CGO_ENABLED=1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GOOS=android \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GOARCH=arm64 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CC=$NDK_BIN/aarch64-linux-android21-clang \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">go build -buildmode=c-shared -o $ANDROID_OUT/arm64-v8a/libsum.so</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="고언어-라이브러리를-ios용으로-컴파일">고언어 라이브러리를 IOS용으로 컴파일<a href="#고언어-라이브러리를-ios용으로-컴파일" class="hash-link" aria-label="고언어 라이브러리를 IOS용으로 컴파일에 대한 직접 링크" title="고언어 라이브러리를 IOS용으로 컴파일에 대한 직접 링크">​</a></h4>
<p>기본적인 컨셉은 안드로이드용 빌드와 동  일하나 약간의 추가과정이 필요함</p>
<ul>
<li>IOS는 static 라이브러리로 컴파일 해야함</li>
<li>시뮬레이터용 <code>arm64</code>와 <em><code>arm64</code> 빌드</em>와 <em>아이폰용 <code>arm64</code> 빌드</em>, 총 세개의 라이브러리로 컴파일</li>
<li>시뮬레이터용 라이브러리 두개를 통합하기 위해 lipo라는 도구를 사용</li>
<li>빌드된 모든 라이브러리를 <code>xframework</code>패키지로 통합</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="플러터에서-사용하기">플러터에서 사용하기<a href="#플러터에서-사용하기" class="hash-link" aria-label="플러터에서 사용하기에 대한 직접 링크" title="플러터에서 사용하기에 대한 직접 링크">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ffigen을-사용해서-바인딩-만들기">FFIgen을 사용해서 바인딩 만들기<a href="#ffigen을-사용해서-바인딩-만들기" class="hash-link" aria-label="FFIgen을 사용해서 바인딩 만들기에 대한 직접 링크" title="FFIgen을 사용해서 바인딩 만들기에 대한 직접 링크">​</a></h4>
<p><code>C</code>라이브러리를 <code>Dart</code> 코드에서 사용할 수 있게 하는 바인딩을 <code>ffigen</code>이라는 도구를 이용해서 자동생성. <code>ffigen</code>을 돌리기 위해 <code>ffigen yaml</code> 작성</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Run with `flutter pub run ffigen --config ffigen.yaml`.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> NativeLibrary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">description</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Bindings to `src/sum.h`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">output</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> `lib/generated_bindings.dart`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">headers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">entry-points</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">`src/libsum.h`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">preamble</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">  // ignore_for_file: always_specify_types</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">  // ignore_for_file: camel_case_types</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">  // ignore_for_file: non_constant_identifier_names</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">  // ignore_for_file: unused_field</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">  // ignore_for_file: unused_element</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">comments</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">style</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> any</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">lenght</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> full</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="다트코드에서-사용하기">다트코드에서 사용하기<a href="#다트코드에서-사용하기" class="hash-link" aria-label="다트코드에서 사용하기에 대한 직접 링크" title="다트코드에서 사용하기에 대한 직접 링크">​</a></h4>
<p>이제 라이브러리를 다트에서 로드하고 <code>generated_bindings.dart</code> 파일에 <code>C</code> 함수로 바인딩된 다트 함수를 호출 가능</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// lib/native_add.dart</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&#x27;dart:ffi&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&#x27;dart:io&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&#x27;generated_bindings.dart&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int </span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">int a</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> int b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> _bindings</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> _libName </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&#x27;native_add&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/// The dynamic library in which the symbols for {NativeAddBindings} can be found.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">DynamicLibrary</span><span class="token plain"> _dylib </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Platform</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isAndroid </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token class-name">Platform</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isLinux</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token class-name">DynamicLibrary</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-literal string" style="color:#e3116c">&#x27;libsum.so&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">throw</span><span class="token plain"> </span><span class="token class-name">UnsupportedError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-literal string" style="color:#e3116c">&#x27;Unknown platform: </span><span class="token string-literal interpolation punctuation" style="color:#393A34">${</span><span class="token string-literal interpolation expression class-name">Platform</span><span class="token string-literal interpolation expression punctuation" style="color:#393A34">.</span><span class="token string-literal interpolation expression">operatingSystem</span><span class="token string-literal interpolation punctuation" style="color:#393A34">}</span><span class="token string-literal string" style="color:#e3116c">&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/// The bindings to the native functions in [_dylib].</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">NativeLibrary</span><span class="token plain"> _bindings </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">NativeLibrary</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_dylib</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="정리">정리<a href="#정리" class="hash-link" aria-label="정리에 대한 직접 링크" title="정리에 대한 직접 링크">​</a></h3>
<ul>
<li><code>C</code> 인터페이스를 제공하는 언어라면 <code>Dart</code>에서 <strong>FFI</strong>를 통해 사용 가능함</li>
<li><code>ffigen</code>을 이용하면 <code>.h</code>를 읽어 자동으로 바인딩 코드를 생성해줌</li>
<li><code>Go</code> 언어의 크로스 컴파일러를 이용해 쉽게 크로스 플랫폼 라이브러리 생성 가능</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>title=&quot;Next Step&quot;</div><div class="admonitionContent_BuS1"><ul>
<li>IOS / macOS / Windows / Linux 등 안드로이드 외 다른 플랫폼 빌드<!-- -->
<ul>
<li>예시는 Android / IOS / macOS 까지만 동작</li>
</ul>
</li>
<li>웹에서도 동작하도록 빌드 (힌트: WebAssembly)</li>
<li>메모리 공유나 비동기 처리등의 고급 사용예제</li>
</ul></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="flutter-webrtc">Flutter WebRTC<a href="#flutter-webrtc" class="hash-link" aria-label="Flutter WebRTC에 대한 직접 링크" title="Flutter WebRTC에 대한 직접 링크">​</a></h2>
<p>Flutter에서 WebRTC를 어떻게 다루는지에 대한 내용을 기대하였지만, 기대했던 내용과는 달리 단순히 WebRTC에 대한 설명만 진행하였다. WebRTC에 대해 잘 알지 못하여 이 내용 또한 유익한 시간이었다.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="서론">서론<a href="#서론" class="hash-link" aria-label="서론에 대한 직접 링크" title="서론에 대한 직접 링크">​</a></h3>
<p>발표자분께서 현재 회사에 영상통화 솔루션을 개발하며 얻은 Flutter WebRTC 지식을 공유해주셨다. WebRTC에 대한 기본 개념과 Flutter 환경에서 WebRTC로 화상 통화를 어떻게 구현하였는지를 공유해주셨다.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="webrtc의-주요-개념">WebRTC의 주요 개념<a href="#webrtc의-주요-개념" class="hash-link" aria-label="WebRTC의 주요 개념에 대한 직접 링크" title="WebRTC의 주요 개념에 대한 직접 링크">​</a></h3>
<p>WebRTC의 <strong>RTC</strong>는 <strong>Real-Time Communication</strong>의 약자이다. 웹 애플리케이션과 사이트가 <strong>중간자 없이</strong> 브라우저간에 <strong>오디오/비디오 스트리밍</strong> 및 데이터 교환을 가능하도록 하는 기술이다.</p>
<p>웹에서 실시간 미디어 스트리밍을 하기위한 <strong>유일한 표준</strong>으로 2010년 Google에 의해 오픈소스화 되었다. 이후 Chrome 등 <strong>모든 브라우저</strong>에 탑재 되었다. (물론 IE에서는 제외 되었지만, IE는 이제 보내주도록 하자 😭) Flutter에서 사용하는 WebRTC도 당연히 동일한 원리로 실행된다.</p>
<p>클라이언트 간의 <strong>직접 연결</strong>로 구현 가능하지만, 클라이언트들이 완전히 같은 네트워크에 있는게 아닌 이상 직접 연결하는 것은 어렵다. 따라서 <strong>시그널링 서버</strong>와 <strong>릴레이 서버</strong> 같은 기술들이 생겨난다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="시그널링signaling-서버">시그널링(Signaling) 서버<a href="#시그널링signaling-서버" class="hash-link" aria-label="시그널링(Signaling) 서버에 대한 직접 링크" title="시그널링(Signaling) 서버에 대한 직접 링크">​</a></h4>
<p><img decoding="async" loading="lazy" alt="webRTC Signaling server" src="/assets/images/webrtc_signaling_server-676d437f552d2b8a1632e9401f7087a4.png" width="582" height="402" class="img_ev3q"></p>
<p>각각의 기기가 <strong>서버의 도움 없이 연결</strong>하는 것을 도와주는 서버로, 뒤에서 다룰 <strong>SDP(Session Description Protocol)</strong> 교환에 관련된 서버이다. 실제 데이터가 시그널링 서버를 통해서 오가는 것이 아니라는 점을 유의하자.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="릴레이relay-서버">릴레이(Relay) 서버<a href="#릴레이relay-서버" class="hash-link" aria-label="릴레이(Relay) 서버에 대한 직접 링크" title="릴레이(Relay) 서버에 대한 직접 링크">​</a></h4>
<p><img decoding="async" loading="lazy" alt="Relay server" src="/assets/images/webrtc_turn_server-fbc97609513ecd67a20566107682a090.png" width="891" height="279" class="img_ev3q"></p>
<p><strong>TURN 서버</strong>라고도 부른다. 방화벽이나 여러 제약으로 인해 <strong>P2P</strong> 연결이 불가능한 상황에서 <strong>클라이언트 간 중계</strong>를 해주는 서버이다. 구글은 개발자들을 위해 <strong>TURN 서버 코드</strong>를 제공하고 있다. TURN 서버를 구현해 놓으면 서로 다른 네트워크에 있어도 P2P처럼 통신이 가능하다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="stun-서버">STUN 서버<a href="#stun-서버" class="hash-link" aria-label="STUN 서버에 대한 직접 링크" title="STUN 서버에 대한 직접 링크">​</a></h4>
<p><strong>STUN 서버</strong>는 <strong>TURN 서버</strong>와 혼동하기 쉽다. <strong>STUN 서버</strong> 는 <strong>Session Traversal Utilities for NAT</strong>의 약자로 통신을 위해 <strong>자기 자신의 정보</strong>를 알아내기 위한 서버이다. 예를 들어, 공유기를 사용하는 환경에서 외부IP를 알아내기 위해 사용된다. 자기 자신을 비추는 거울로 생각하면 된다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="rtcpeerconnection-객체">RTCPeerConnection 객체<a href="#rtcpeerconnection-객체" class="hash-link" aria-label="RTCPeerConnection 객체에 대한 직접 링크" title="RTCPeerConnection 객체에 대한 직접 링크">​</a></h4>
<p>WebRTC를 위해 제공되는 Web API 객체이다. 웹 브라우저 또는 네이티브 앱에서 직접적인 통신 연결을 생성 및 관리하고, 데이터 스트림을 교환하는 역할을 수행한다. 이를 잘 이해하고 활용한다면 WebRTC 구현을 위해 개발자가 할 일이 크게 줄어들 것이다.</p>
<p><strong>RTCPeerConnection</strong>이 하는 역할은 다음과 같다</p>
<ul>
<li>offer, answer, ice-candidate 등 WebRTC를 위한 <strong>신호처리</strong></li>
<li>STUN 및 TURN 서버를 사용한 <strong>NAT 및 방화벽 통과</strong></li>
<li>사용자의 디바이스(카메라, 마이크)에서 오는 <strong>미디어 스트림 관리</strong></li>
<li>클라이언트 간 데이터를 직접 교환하기 위한 <strong>데이터 채널 생성</strong></li>
<li>통신 세션이 초기화 되거나 변경될 때 <strong>세션 협상</strong> 및 <strong>재협상</strong></li>
<li>모든 통신을 자동으로 암호화하여 <strong>중간자 공격</strong>으로부터 보호</li>
<li>통계 및 네트워크 정보 제공</li>
</ul>
<p>WebRTC의 경우 Flutter만을 위한 자료가 거의 없으므로 <a href="https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection" target="_blank" rel="noopener noreferrer">MDN 사이트</a>를 통해 확인하는 것이  좋다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="sdp-session-description-protocol">SDP (Session Description Protocol)<a href="#sdp-session-description-protocol" class="hash-link" aria-label="SDP (Session Description Protocol)에 대한 직접 링크" title="SDP (Session Description Protocol)에 대한 직접 링크">​</a></h4>
<p>발신자와 수신자는 모두 <strong>클라이언트</strong>이므로 통신 환경이 다른 경우가 대부분이다. 따라서 SDP를 통해 서로의 <strong>미디어 능력</strong> 및 <strong>연결 정보</strong>를 공유해야 한다.</p>
<p>SDP에는 오디오 및 비디오 코덱, 미디어 스트림의 방향, RTP(Real-time Transport Protocol) 엔드포인트 정보가 포함된다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ice-interactive-connectivity-establishment">ICE (Interactive Connectivity Establishment)<a href="#ice-interactive-connectivity-establishment" class="hash-link" aria-label="ICE (Interactive Connectivity Establishment)에 대한 직접 링크" title="ICE (Interactive Connectivity Establishment)에 대한 직접 링크">​</a></h4>
<p>일반적으로 발신자와 수신자는 <strong>서로 다른 네트워크</strong>를 사용하게 된다. 하지만 발신자에서 수신자로, 수신자에서 발신자로 가는 네트워크 경로는 다양하므로 다른 네트워크에 속한 클라이언트 간 통신 구현은 어렵다. ICE는 발신자 또는 수신자 입장에서 <strong>내게 오는 길</strong>을 알려준다.</p>
<p>ICE Candidate는 다음 내용을 포함한다. IP 주소, 포트 번호, 프로토콜(UDP 또는 TCP), Candidate 유형(host, srflx, prflx, relay 등 포함)</p>
<p>각 피어는 <strong>자신의 모든 후보를 수집</strong>한 후 이를 다른 피어와 교환한다. 양쪽 피어는 <strong>가능한 모든 후보 조합</strong>에 대해 연결성 검사를 수행하며 <strong>가장 높은 우선순위</strong>를 가진 후보 조합이 선택되어 미디어 통신에 사용된다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="websocket">WebSocket<a href="#websocket" class="hash-link" aria-label="WebSocket에 대한 직접 링크" title="WebSocket에 대한 직접 링크">​</a></h4>
<p>WebRTC에서 WebSocket이 반드시 필요하지는 않지만, <strong>실시간 양방향 통신</strong>에서의 이점 때문에 많이 활용된다.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="webrtc-관련-flutter-패키지">WebRTC 관련 Flutter 패키지<a href="#webrtc-관련-flutter-패키지" class="hash-link" aria-label="WebRTC 관련 Flutter 패키지에 대한 직접 링크" title="WebRTC 관련 Flutter 패키지에 대한 직접 링크">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="flutter_webrtc">flutter_webrtc<a href="#flutter_webrtc" class="hash-link" aria-label="flutter_webrtc에 대한 직접 링크" title="flutter_webrtc에 대한 직접 링크">​</a></h4>
<p>Flutter에서 WebRTC 기능을 이용하기 위한 패키지로 기본적으로는 iOS, Android 등 다양한 플랫폼을 위해 제공되는 WebRTC 공식 <strong>네이티브 패키지</strong>를 <strong>메서드 채널</strong>로 묶어 놓은 구조이다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="web_socket_channel">web_socket_channel<a href="#web_socket_channel" class="hash-link" aria-label="web_socket_channel에 대한 직접 링크" title="web_socket_channel에 대한 직접 링크">​</a></h4>
<p>Dart/Flutter에서 WebSocket 관련 기능을 제공한다. Web API에 비해 아직은 일부 기능을 지원하지 못하는 등 조금 미흡하다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="flutter_callkeep">flutter_callkeep<a href="#flutter_callkeep" class="hash-link" aria-label="flutter_callkeep에 대한 직접 링크" title="flutter_callkeep에 대한 직접 링크">​</a></h4>
<p>Flutter에서 전화 수신 및 발신 UI를 처리하는 기능을 제공해준다. iOS는 CallKit을 사용하며, Android는 자체 UI를 띄워준다. iOS CallKit 구현을 위해서는 별도로 VoIP Push 구현이 필요하다</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="webrtc--websocket-동작흐름">WebRTC &amp; WebSocket 동작흐름<a href="#webrtc--websocket-동작흐름" class="hash-link" aria-label="WebRTC &amp; WebSocket 동작흐름에 대한 직접 링크" title="WebRTC &amp; WebSocket 동작흐름에 대한 직접 링크">​</a></h3>
<p><img decoding="async" loading="lazy" alt="WebRTC and WebSocket flow" src="/assets/images/webrtc_and_websocket_1-08dc88c139152196fe4bb30c60967e60.png" width="924" height="471" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="WebRTC and WebSocket flow 2" src="/assets/images/webrtc_and_websocket_2-9926859faf23275c41cd51017e986b1e.png" width="907" height="429" class="img_ev3q"></p>
<p>WebSocket이 연결되면 WebSocket을 통해 connect 데이터가 전송된다. (발신자, 수신자 모두)</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;connect&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;callId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>connect 수신 시 발신자와 수신자는 다음 동작을 수행한다.</p>
<ol>
<li>RTCPeerConnection 객체 초기화</li>
<li>onIceCandidate 이벤트 리스너 추가(ice-candidate 전송)</li>
<li>onAddStream 이벤트 리스너 추가(Remote Stream 초기화, Remote Renderer를 Remote Stream과 연결, Local Renderer를 Local Stream 과 연결)</li>
<li>Local Stream 초기화</li>
<li>수신자는 offer 생성 및 발신</li>
</ol>
<p>offer와 answer는 <strong>SDP</strong>를 교환하기 위해 이루어진다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="offer">offer<a href="#offer" class="hash-link" aria-label="offer에 대한 직접 링크" title="offer에 대한 직접 링크">​</a></h4>
<p>수신자는 connect를 받으면 offer를 보낸다.</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;offer&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;sdp&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;callID&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;restart&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;boolean&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="answer">answer<a href="#answer" class="hash-link" aria-label="answer에 대한 직접 링크" title="answer에 대한 직접 링크">​</a></h4>
<p>발신자는 offer를 받았을 때 answer를 보낸다.</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;answer&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;sdp&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;callId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<ul>
<li>
<p>수신자의 offer 발신 동작</p>
<ol>
<li>offer 생성</li>
<li>RTCPearConnection 객체를 다음과 같이 설정 - Local Description: offer</li>
<li>발신자에게 offer 전송</li>
</ol>
</li>
<li>
<p>발신자의 offer 수신 &amp; answer 발신 동작</p>
<ol>
<li>RTCPeerConnection 객체를 다음과 같이 설정 - Remote Description: offer</li>
<li>sdp 기반 answer 생성</li>
<li>RTCPeerConnection 객체를 다음과 같이 설정 - Local Description: answer</li>
<li>수신자에게 answer 전송</li>
<li>통화 시작을 위한 UI 처리</li>
</ol>
</li>
<li>
<p>수신자의 answer 수신 동작</p>
<ol>
<li>RTCPeerConnection 객체를 다음과 같이 설정 - Remote Description: answer</li>
<li>통화 시작을 위한 UI 처리</li>
</ol>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ice-candidate">ice-candidate<a href="#ice-candidate" class="hash-link" aria-label="ice-candidate에 대한 직접 링크" title="ice-candidate에 대한 직접 링크">​</a></h4>
<p>ICE Candidate를 수신하고 RTCPeerConnection 객체에 ICE Candidate를 <strong>모두 추가</strong></p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ice-candidate&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;candidate&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;candidate&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;sdpMid&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;sdpMLineIndex&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;int&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;callId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>offer-answer 교환이 끝나기 전에 ICE Candidate 교환이 먼저 일어나는 경우도 있다. 이때는 <strong>별도의 리스트</strong>에 ICE Candidate를 모두 저장해 뒀다가 offer-answer가 발생 했을 때 <strong>Peer Connection</strong>에 ICE Candidate를 추가해주면 된다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="leave">leave<a href="#leave" class="hash-link" aria-label="leave에 대한 직접 링크" title="leave에 대한 직접 링크">​</a></h4>
<p>통화를 종료하기 위해 이루어진다. 수신자와 발신자 중 어느 한 쪽이 leaave를 전송하면 즉시 <strong>통화 종료</strong> 된다.(서로 leave를 교환할 필요가 없다.)</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;leave&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;callId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="flutter-webrtc를-위한-팁">Flutter WebRTC를 위한 팁<a href="#flutter-webrtc를-위한-팁" class="hash-link" aria-label="Flutter WebRTC를 위한 팁에 대한 직접 링크" title="Flutter WebRTC를 위한 팁에 대한 직접 링크">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="수신자의-응답-이전-발신자의-통화-종료">수신자의 응답 이전 발신자의 통화 종료<a href="#수신자의-응답-이전-발신자의-통화-종료" class="hash-link" aria-label="수신자의 응답 이전 발신자의 통화 종료에 대한 직접 링크" title="수신자의 응답 이전 발신자의 통화 종료에 대한 직접 링크">​</a></h4>
<p>서버에서 수신자에게 <code>&quot;HUNGUP&quot;</code> Push 알림을 보내 전화 수신 화면, 소리, 진동이 뜨지 않도록 해야한다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="수신자의-통화-거절">수신자의 통화 거절<a href="#수신자의-통화-거절" class="hash-link" aria-label="수신자의 통화 거절에 대한 직접 링크" title="수신자의 통화 거절에 대한 직접 링크">​</a></h4>
<p>서버에서 발신자에게 <code>&quot;REJECTED&quot;</code> Push 알림을 보내 video 화면에서 빠져나오도록 한다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="수신자가-여러-기기-중-하나의-기기에서-응답">수신자가 여러 기기 중 하나의 기기에서 응답<a href="#수신자가-여러-기기-중-하나의-기기에서-응답" class="hash-link" aria-label="수신자가 여러 기기 중 하나의 기기에서 응답에 대한 직접 링크" title="수신자가 여러 기기 중 하나의 기기에서 응답에 대한 직접 링크">​</a></h4>
<p>서버에서 수신자의 다른 기기들에 <code>&quot;RESPONDED&quot;</code> Push 알림을 보내 전화 수신 화면, 소리, 진동이 뜨지 않도록 해야한다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="통화-종료">통화 종료<a href="#통화-종  료" class="hash-link" aria-label="통화 종료에 대한 직접 링크" title="통화 종료에 대한 직접 링크">​</a></h4>
<p>통화 종료 시에는, 한쪽이 <code>&quot;leave&quot;</code> 메시지를 상대편에 보내면 둘다 종료된다.
하지만 여러가지 이유로 이 동작이 정상적으로 진행되지 못하는 경우가 있는데, 이때는 signaling 서버에서 <code>&quot;leave&quot;</code> 메시지를 디바이스에 보내서 종료하도록 한다.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="shorebird-작동-방식">ShoreBird 작동 방식<a href="#shorebird-작동-방식" class="hash-link" aria-label="ShoreBird 작동 방식에 대한 직접 링크" title="ShoreBird 작동 방식에 대한 직접 링크">​</a></h2>
<p>멀티 플랫폼 모바일 애플리케이션 개발을 위해 많이 사용되는 프레임워크 하면 ReactNative, Flutter 와 같은 프레임워크들이 생각날 것이다. RN(ReactNative) 하면 여러 기능중 단연 <strong>Code Push</strong> 를 먼저 떠올릴 수 있는데, <code>Flutter</code> 에서 <code>Code push</code> 를 적용하기 위해 만들어진 서비스인 <code>Shorebird</code>에 대해 알아보자.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="code-push란">Code push란?<a href="#code-push란" class="hash-link" aria-label="Code push란?에 대한 직접 링크" title="Code push란?에 대한 직접 링크">​</a></h3>
<ul>
<li>
<p>코드 수정 시 디바이스에서 업데이트를 하지 않아도 지속적으로 사용자가 변경사항을 가져올 수 있다</p>
</li>
<li>
<p>대부분의 큰 애플리케이션들은 <code>Code push</code>를 사용중이다.</p>
<ul>
<li><em>Large install base = long store update time</em> 이므로</li>
</ul>
</li>
<li>
<p>비즈니스에서 현실적인 문제들</p>
<ul>
<li>Downtime = lost revenue</li>
<li>Code push = insurance you can fix things quickly if they go wrong</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="풍성한-  디자인-요청사항에-대응하기">풍성한 디자인 요청사항에 대응하기<a href="#풍성한-디자인-요청사항에-대응하기" class="hash-link" aria-label="풍성한 디자인 요청사항에 대응하기에 대한 직접 링크" title="풍성한 디자인 요청사항에 대응하기에 대한 직접 링크">​</a></h2>
<p>LINE 2년차 주니어 개발자로 일하면서 플러터를 사용하여 여러 디자인 요구사항들을 해결한 경험들을 공유한 시간이었다.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="custompaint를-활용한-container">CustomPaint를 활용한 Container<a href="#custompaint를-활용한-container" class="hash-link" aria-label="CustomPaint를 활용한 Container에 대한 직접 링크" title="CustomPaint를 활용한 Container에 대한 직접 링크">​</a></h3>
<p>다양한 모양의 컨테이너를 생성하기 위해 CustomPaint를 사용하여 오각형의 도형을 만들며 동적으로 수정할 수 있도록 변경한 방법들에 대해 공유해주셨다.</p>
<p><code>CustomPaint</code> 의 경우 Flutter 에서 매우 중요하게 활용된다. 특히 Interactive 한 화면을 디자인하기 위해 Animation 효과를 적용할 때 Svg 파일을 CustomPaint로 변환하면서 특히 많이 활용이 되는데, 현재 회사에서 apple의 <a href="https://developer.apple.com/sf-symbols/" target="_blank" rel="noopener noreferrer">SF Symbols</a>와 유사하게 아이콘들을 커스텀 가능하게 수정하는 작업을 하며 보고있던 부분이라 반가운 주제였다.</p>
<p>발표내용은 간단한 path 를 생성하는 방법을 공유해주는 조금 쉬운 내용이었지만, <code>Flutter</code>를 처음 접하며 겪었던 고민들과 같은 고민을 해봤던 개발자 동료를 만나 반가웠다.</p>
<p>추가로 <code>CustomPaint</code> 의 경우 <code>Flutter</code> 팀에서 <code>SVG</code> 를 대체하기 위해 최적화를 신경써서 좋은 성능으로 화면에 아이콘이나 벡터이미 지를 생성할 수 있게 해주었는데, 이와 관련하여 <a href="https://www.youtube.com/watch?v=w9lD35D78N8" target="_blank" rel="noopener noreferrer">Youtube</a>에서 설명한 내용도 참고하자</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="loading-skeleton">Loading Skeleton<a href="#loading-skeleton" class="hash-link" aria-label="Loading Skeleton에 대한 직접 링크" title="Loading Skeleton에 대한 직접 링크">​</a></h3>
<p>최근 로딩화면을 단순히 Circular Loader로 구현하지 않고 사용자로 하여금 어떤 자료들이 보여질지 예측이 가능하도록 디자인하는 Skeleton Design을 많이 적용하고 있는 것으로 알고있다. 현재 회사에서도 이러한 점 때문에 팀원분들과 디자이너분께 강력하게 어필하여 Loading Skeleton을 모두 적용하였었는데, 마찬가지로 적용했던 내용과 같은 것을 듣게되어 놀랐다.</p>
<p>발표 내용은 두개의 컨테이너를 교차하여 빛반사가 움직이는 효과를 적용한 과정에 대해 간략하게 설명해 주셨고 <code>Shimmer</code> 라는 Package를 사용하면 보다 간편하게 적용할 수 있음을 공유해주셨다.</p>
<p>하지만, 두개의 컨테이너를 교차하지 않아도 CustomPaint를 활용하면 같은 효과를 낼 수 있다. Gradient 범위를 설정해주면 범위 밖의 색상은 가장 바깥에 설정해준 색상으로 표시되기 때문에 동일한 효과를 낼 수 있다.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="customscrollview--dropdown">CustomScrollView + Dropdown<a href="#customscrollview--dropdown" class="hash-link" aria-label="CustomScrollView + Dropdown에 대한 직접 링크" title="CustomScrollView + Dropdown에 대한 직접 링크">​</a></h3>
<p>마지막 발표내용까지도 이전에 Help 페이지를 적용하며 구현했던 Scroller 의 위치를 가져와 UI에 적용하는, 이번 회사에 들어오고 한달동안 뜯어 고쳤던 UI들에 대한 내용들이 모두  나와서 깜짝 놀랐다.. 역시 어느회사나 하는 일들은 비슷한 것 같다.</p>
<p>발표자분의 경우 화면 스크롤 시 CustomScrollView 위에 표시해준 Overlay가 화면이 스크롤될 때 같이 올라가는 문제가 있었고 이를 Scrollbar offset을 가져와 높이를 계속 추가해주어 해결한 내용에 대해 공유해 주었다.</p>
<p>이 부분에 있어서도 <code>Flutter</code> 의 Overlay 위젯을 활용하면 <code>Main</code> 위젯을 부모요소로 가지므로 해결가능한 문제였지만, 스크롤바의 offset을 가져와서 다양한 Interaction을 구현하는 방식은 많이 활용되므로 어떻게 코드를 작성하였는지 흥미롭게 들었다.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="디자이너와-소통하기">디자이너와 소통하기<a href="#디자이너와-소통하기" class="hash-link" aria-label="디자이너와 소통하기에 대한 직접 링크" title="디자이너와 소통하기에 대한 직접 링크">​</a></h3>
<p>디자이너분들과 메신저를 통해서 소통한 방법들과 내용들에 대해 공유해주셨다. 명확하게 의견을 주고받을 수 있도록 다양한 방법을 제공해주셨는데 해당 방법들은 다음과 같다.</p>
<ul>
<li>내가 이해한 바를 정확하게 공유하기</li>
<li>질문할 때는 이해가 쉽게 시각 자료를 첨부하기</li>
<li>선택이 필요할 때는 가능한 옵션을 먼저 제공하기</li>
<li>디자이너의 의도와 동일하게 구현하기 위해 최선을 다하기</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="플러터-렌더링-해부학">플러터 렌더링 해부학<a href="#플러터-렌더링-해부학" class="hash-link" aria-label="플러터 렌더링 해부학에 대한 직접 링크" title="플러터 렌더링 해부학에 대한 직접 링크">​</a></h2>
<p>Flutter Seoul의 오거나이저로 활동 중이신 에이든님의 발표로 플로터 위젯이 화면에 표시될 때 어떠한 방식으로 렌더링이 되는지, Dart 코드를 뜯어보며 확인해보도록 자료를 준비해주셨다. 에이든님의 경우 Flutter 월간 세미나에서도 Flutter Web의 Image 렌더링에 대한 발표를 들었었는데, 두 내용 모두 찾아보기 귀찮고 생각만해도 피곤한 내용들을 꼼꼼히 잘 설명해주셔서 많은 도움이 되었다.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="랜더링-과정">랜더링 과정<a href="#랜더링-과정" class="hash-link" aria-label="랜더링 과정에 대한 직접 링크" title="랜더링 과정에 대한 직접 링크">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="widget">Widget<a href="#widget" class="hash-link" aria-label="Widget에 대한 직접 링크" title="Widget에 대한 직접 링크">​</a></h4>
<p>위젯은 플러터를 시작할 때 가장 먼저 접하는 클래스이자, 개발 과정에서 가장 자주 사용하는 클래스이다. 플러터 개발자에게 있어 위젯은 앱 개발의 가장 핵심적인 요소라고 할 수 있을 것이다.</p>
<p>플러터 공식 문서를 보면 <strong>Widget</strong>은 <code>&quot;Describes the configuration for an Element&quot;</code> &quot;Widget은 Element의 구성을 표현하는 객체&quot; 라고 설명한다. 하지만 플러터 개발자들 사이에 위젯에 대한 설명으로 이보다 더 널리 알려진 설명이 있는데 바로 <code>&quot;In Flutter, almost everything is a widget&quot;</code>이다. 여기서 흥미로운 점은 <code>&#x27;almost everything&#x27;</code> &#x27;거의 모든 것&#x27;이라는 표현인데 위젯을 **&#x27;거의 모든 것&#x27;**이라 설명하는 이유는 무엇일까? 또 그렇다면 거의 모든 것에 포함되지 않는 것들은 어떤 것들이 있을까</p>
<p>**&#x27;Almost everything&#x27;**인 Widget 너머, 화면을 그리는 자세한 과정을 살펴보며 이를 알아보자</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="coloredbox">ColoredBox<a href="#coloredbox" class="hash-link" aria-label="ColoredBox에 대한 직접 링크" title="ColoredBox에 대한 직접 링크">​</a></h4>
<p>화면에 색을 칠하는 간단한 프로젝트를 구현하려 한다. 색을 칠하는데 흔히 사용되는 <code>Container</code>가 아닌 <code>ColoredBox</code>위젯을 사용하여 이를 구현해보자.</p>
<p>아래는 <code>ColoredBox</code> 위젯을 이용해 사각형의 Box 공간을 녹색으로 칠하는 간단한 코드이다. 렌더링 과정을 살펴보기 위해 <code>MaterialApp</code>이나 <code>Scafford</code>를 사용하지 않고 위젯트리를 간단히 구성하였다.</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">ColoredBox</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&#x27;package:flutter/material.dart&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">runApp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token class-name">ColoredBox</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      color</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Colors</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">green</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="ColoredBox" src="/assets/images/flutter_rendering_1-44c8585ca13aec3e7c7478b7958eb4f3.png" width="855" height="482" class="img_ev3q"></p>
<p>ColoredBox 위젯의 생성자로 녹색을 전달했기 때문에 실행하면 녹색으로 가득찬 화면을 볼 수 있을 것이다.</p>
<p>widget에 대한 설명을 다시 한번 떠올려보자 <code>&quot;Describes the configuration for an Element&quot;</code>, Widget은 Element의 구성을 표현하는 객체일 뿐이다.</p>
<p>다음으로 Widget인 ColoredBox가 Element를 어떻게 구성하는지, ColoredBox를 뜯어보며 확인해보자</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">ColoredBox</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ColoredBox</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">SingleChildrenderObjectWidget</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token metadata function" style="color:#d73a49">@override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">RenderObject</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createRenderObject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">BuildContext</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_RenderColoredBox</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">color</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> color</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">abstract</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">SingleChildRenderObjectWidget</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">RenderObjectWidget</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token metadata function" style="color:#d73a49">@override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">SingleChildRenderObjectElement</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createElement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token class-name">SingleChildRenderObjectElement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">abstract</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">RenderObjectWidget</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">Widget</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>위 코드를 통해 <code>ColoredBox</code> 위젯을 확인해보면 <code>ColoredBox</code> 위젯은 <code>SingleChildRenderObjectWidget</code>을 확장하고 있다. 또 <code>SingleChildRenderObjectWidget</code>은 <code>RenderObjectWidget</code>을 확장하고 있고, <code>RenderObjectWidget</code>은 <code>Widget</code>을 확장하고 있다. 이러한 클래스 계층을 따라가보면 알 수 있듯 <code>ColoredBox</code>는 <code>Widget</code>의 구현체이다.</p>
<p>이를 표로 그려보면 다음과 같이 표현할 수 있다.</p>
<p><img decoding="async" loading="lazy" alt="ColoredBox Diagram" src="/assets/images/flutter_rendering_2-25b4b507d352fd0fa7c2711f9b156550.png" width="825" height="464" class="img_ev3q"></p>
<p><code>ColoredBox</code>가 렌더링되는 자세한 과정을 살펴보려면 <code>RenderObject</code>를 반환하는 <code>createRenderObject</code>와 <code>SingleChildRenderObjectElement</code>를 반환하는 <code>createElement</code>를 살펴봐야한다.</p>
<p>아직은 두 메소드가 어떻게 호출되는지 알기 어렵겠지만, 이 내용을 모두 본 후에는 두 메소드가 렌더링에 어떻게 관여하는지 모두 알게될테니 지금은 <code>createRenderObject</code>와 <code>createElement</code>를 <code>Widget</code>에서 오버라이드하고 있다는 사실만 기억한체 넘어가자.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="element">Element<a href="#element" class="hash-link" aria-label="Element에 대한 직접 링크" title="Element에 대한 직접 링크">​</a></h4>
<p>이번에는 <code>SingleChildRenderObjectWidget</code>이 오버라이드하고 있는 <code>createElement</code>가 생성하는 <code>Element</code>에 대해 살펴보자.</p>
<p>플러터 공식문서를 보면 <code>Element</code> 클래스에 대해 이렇게 설명한다. <code>&quot;an instantiation of Widget at a particular location in the tree&quot;</code>, <code>Element</code>는 트리의 특정 위치에 있는 위젯을 인스턴스이다.</p>
<p><code>Element</code>의 동작을 확인하기 위해 <code>SingleChildRenderObjectWidget</code>의 클래스 계층 구조를 살펴보자.</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">SingleChildRenderObjectWidget</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">abstract</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">SingleChildRenderObjectWidget</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">RenderObjectWidget</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token metadata function" style="color:#d73a49">@override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">SingleChildRenderObjectElement</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createElement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token class-name">SingleChildRenderObjectElement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">SingleChildRenderObjectElement</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">RenderObjectElement</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">abstract</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">RenderObjectElement</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">Element</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">RenderObject</span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> _renderObject</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token metadata function" style="color:#d73a49">@override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Element</span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> parent</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Object</span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> newSlot</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">mount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parent</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> newSlot</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _renderObject </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">widget </span><span class="token operator" style="color:#393A34">as</span><span class="token plain"> </span><span class="token class-name">RenderObjectWidget</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">createRenderObject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">attachRenderObject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">newSlot</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">performRebuilde</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">abstract</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Element</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">DiagnosticableTree</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">BuildContext</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">Widget</span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> _widget</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>앞서 <code>ColoredBox</code> Widget이 확장한 <code>SingleChildRenderObjectWidget</code>은 <code>createElement</code> 메소드를 통해서 <code>SingleChildRenderObjectElement</code>를 생성하는걸 살펴보았다. <code>SingleChildRenderObjectElement</code>는 <code>RenderObjectElement</code>를 확장하고 있고, <code>RenderObjectElement</code>는 <code>Element</code>를 확장하고 있다.</p>
<p><code>Element</code>는 <code>BuildContext</code>를 구현한 추상클래스로 <code>Widget</code>을 프로퍼티로 들고, 필요한 시점에 <code>build</code> 메소드를 호출하게 된다. 이를 표에 추가하면 다음과 같이 표현할 수 있다.</p>
<p><img decoding="async" loading="lazy" alt="Widget Diagram" src="/assets/images/flutter_rendering_3-8d51bff35c523ec83d1684e36b769cb9.png" width="840" height="474" class="img_ev3q"></p>
<p><code>Element</code> 클래스의 계층 중 렌더링과 관련해서 주의깊게 살펴볼 부분은 <code>RenderObjectElement</code> 클래스의 <code>RenderObject</code>   프로퍼티와 <code>mount</code> 메소드이다.</p>
<p><code>mount</code>가 호출되면 <code>Widget</code>의 <code>createRenderObject</code> 메소드를 호출해 화면을 그리는데 직접적으로 사용될 <code>RenderObject</code>를 생성한다. 생성된 <code>RenderObject</code>는 <code>attachRenderObject</code>에 전달해 렌더오브젝트의 트리를 구성한다. 그렇다면 이 <code>mount</code> 메소드는 어떻게 호출되는 걸까?</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="runapp">runApp<a href="#runapp" class="hash-link" aria-label="runApp에 대한 직접 링크" title="runApp에 대한 직접 링크">​</a></h4>
<p><code>mount</code>가 호출되는 과정을 살펴보려면 먼저, Widget 만큼 익숙한 <code>runApp</code> 함수를 살펴봐야한다. 플러터 프로젝트를 생성하면 <code>main</code> 함수에서 <code>runApp</code> 함수를 호출하는 코드가 생성되는데, 이 <code>runApp</code>을 따라가면 <code>mount</code>에 다다를 수 있다.</p>
<p>플러터 공식 문서에서는 <code>runApp</code> 함수에 대해 이렇게 이야기한다. <code>&quot;Inflate the given widget and attach it to the view&quot;</code> <code>runApp</code> 함수는 함수의 인자로 전달한 위젯을 <code>inflate</code>하고 <code>view</code>에 추가한다. 그렇다면 <code>Widget</code>을 어떻게 <code>inflate</code>하고, <code>view</code>에 추가하는지 <code>runApp</code> 함수의 내부 동작을 뜯어보며 확인해보자.</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">runApp</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">runApp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Widget</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">WidgetsBinding</span><span class="token plain"> binding </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">WidgetsFlutterBinding</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ensureInitialized</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">_runWidget</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">binding</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">wrapWithDefaultView</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> binding</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&#x27;runApp&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">mixin</span><span class="token plain"> </span><span class="token class-name">WidgetsBinding</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">on</span><span class="token plain"> </span><span class="token class-name">BindingBase</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">ServicesBinding</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">SchedulerBinding</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">GestureBinding</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">RendererBinding</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">SemanticsBinding</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">//...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">//...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">Widget</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">wrapWithDefaultView</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Widget</span><span class="token plain"> rootWidget</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token class-name">View</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      view</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> platformDispatcher</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">implicitView</span><span class="token operator" style="color:#393A34">!</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      deprecatedDoNotUseWillBeRemovedWithoutNoticePipelineOwner</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> pipelineOwner</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      deprecatedDoNotUseWillBeRemovedWithoutNoticeRenderViw</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> renderView</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      child</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> rootWidget</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><code>runApp</code> 함수의 내부에서는 <code>WidgetsFlutterBinding</code>의 <code>ensureInitialized</code>를 호출하여 플러터 어플리케이션 동작을 위한 초기화를 한다. <code>ensureInitialized</code>가 반환한 <code>WidgetsBinding</code>객체의 <code>wrapWithDefaultView</code> 메소드를 호출하면 <code>runApp</code> 함수에 전달된 위젯이 <code>View</code>의 <code>child</code>로 추가되는데 이를 통해 <code>wrapWithDefaultView</code>가 view에 위젯을 추가하는 역하를 하는 것을 알 수 있다.</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_runWidget</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Widget</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">WidgetsBinding</span><span class="token plain"> binding</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> debugEntryPoint</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  binding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">scheduleAttachRootWidget</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>이번에는 <code>&quot;Inflate the ginen widget&quot;</code>를 확인해보자 <code>runApp</code> 함수는 <code>private</code> 함수인 <code>_runWidget</code> 함수의 <code>scheduleAttachRootWidget</code>을 호출하며
<code>wrapWithDefaultView</code>가 생성한 view를 전달한다.</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">mixin</span><span class="token plain"> </span><span class="token class-name">WidgetsBinding</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">on</span><span class="token plain"> </span><span class="token class-name">BindingBase</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">ServicesBinding</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">ScheduleBinding</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">GestureBinding</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">RendererBinding</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">SementicsBinding</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token metadata function" style="color:#d73a49">@protect</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">scheduleAttachRootWidget</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Widget</span><span class="token plain"> rootWidget</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token class-name">Timer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">attachRootWidget</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rootWidget</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><code>scheduleAttachRootWidget</code>은 <code>attachRootWidget</code>을 호출하고,</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">mixin</span><span class="token plain"> </span><span class="token class-name">WidgetsBinding</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">on</span><span class="token plain"> </span><span class="token class-name">BindingBase</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">ServicesBinding</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">ScheduleBinding</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">GestureBinding</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">RendererBinding</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">SementicsBinding</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">//...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">attachRootWidget</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Widget</span><span class="token plain"> rootWidget</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">attachToBuildOwner</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">RootWidget</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      debugShortDescription</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&#x27;[root]&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      child</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> rootWidget</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">attachToBuildOwner</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">RootWidget</span><span class="token plain"> widget</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _rootElement </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> widget</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">attach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buildOwner</span><span class="token operator" style="color:#393A34">!</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> rootElement </span><span class="token operator" style="color:#393A34">as</span><span class="token plain"> </span><span class="token class-name">RootElement</span><span class="token operator" style="color:#393A34">?</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><code>attachRootWidget</code>은 <code>RootWidget</code>을 생성해 <code>attachToBuildOwner</code>에 전달한다. <code>attachToBuildOwner</code> 메소드에서는 인자로 전달된 <code>RootWidget</code>의 <code>attach</code>를 호출하는데, <code>attach</code>의 두 번째 인자에는 <code>rootElement</code>가 <code>null</code>인 상태로 호출된다.</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">RootWidget</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">Widget</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">RootElement</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">attach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">BuildOwner</span><span class="token plain"> owner</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token class-name">RootElement</span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> element </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">element </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      owner</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">lockState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        element </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createElement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        element</span><span class="token operator" style="color:#393A34">!</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">assignOwner</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">owner</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      owner</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">buildScope</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">element</span><span class="token operator" style="color:#393A34">!</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        element</span><span class="token operator" style="color:#393A34">!</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">mount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token comment" style="color:#999988;font-style:italic">/* parent */</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* slot */</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><code>RootWidget</code>의 <code>attach</code>에서는 <code>createElement</code>를 호출해 <code>RootElement</code>를 생성하고, 생성된 <code>RootElement</code>의 <code>mount</code>를 호출한다.</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">RootElement</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">Element</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token class-name">RootElementMixin</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token metadata function" style="color:#d73a49">@override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Element</span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> parent</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Object</span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> newSlot</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">_rebuild</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_rebuild</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _child </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">updateChild</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_child</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">widget </span><span class="token operator" style="color:#393A34">as</span><span class="token plain"> </span><span class="token class-name">RootWidget</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">child</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* slot */</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">abstract</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Element</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">DiagnosticableTree</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">BuildContext</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">Element</span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">updateChild</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Element</span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> child</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Widget</span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> newWidget</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Object</span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> newSlot</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">Element</span><span class="token plain"> newChild </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">inflateWidget</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">newWidget</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> newSlot</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> newChild</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><code>RootElement</code>의 <code>mount</code>는 <code>_rebuild</code>, <code>updateChild</code>를 거쳐 <code>inflateWidget</code>을 호출하는데 <code>runApp</code> 함수가 위젯을 <code>inflate</code>하는 역할을 <code>RootElement</code>에서 수행한다.</p>
<p>정리하자면 <code>runApp</code> 함수는 <code>RootWidget</code>, <code>RootElement</code>를 생성해 위젯트리와 엘리먼트 트리의 루트를 생성하고, <code>widget</code>의 <code>build</code> 메소드를 계층적으로 호출하기 위한 트리를 구성하는 역할을 한다.</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">abstract</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">RenderObjectElement</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">Element</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">RenderObject</span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> _renderObject</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token metadata function" style="color:#d73a49">@override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Element</span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> parent</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Object</span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> newSlot</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">mount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parent</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> newSlot</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _renderObject </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">widget </span><span class="token operator" style="color:#393A34">as</span><span class="token plain"> </span><span class="token class-name">RenderObjectWidget</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">createRenderObject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">attachRenderObject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">newSlot</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">performRebuild</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>위젯이 계층적으로 생성되는 과정에서 렌더링에 관여하는 <code>RenderObjectElement</code>의 <code>mount</code>가 호출되는데 이때 렌더링에 사용되는 <code>RenderObject</code> 객체가 생성되고, 렌더트리에 추가되는 것이다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="renderobject">RenderObject<a href="#renderobject" class="hash-link" aria-label="RenderObject에 대한 직접 링크" title="RenderObject에 대한 직접 링크">​</a></h4>
<p>렌더링에 직접적으로 관여하는 <code>RenderObject</code>에 도달하기까지 기나긴 여정이었다. 실제 렌더링은 비교적 단순하다. <code>RenderObject</code>는 공식 문서에서 <strong>렌더트리</strong>를 구성하는 오브젝트라 설명한다. 렌더트리를 구성하는 다양한 <code>RenderObject</code>가 렌더링을 처리하는 것이다. <code>RenderObject</code>는 직접적인 페인팅 외에도 레이아웃과 유저 입력에 대한 영역 검사, 접근성 등을 처리하는데, 이번 시간에는 <code>RenderObject</code>의 다양한 역할 중 페인팅에 대해 자세히 알아보자.</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ColoredBox</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">SingleChildrenderObjectWidget</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token metadata function" style="color:#d73a49">@override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">RenderObject</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createRenderObject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">BuildContext</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_RenderColoredBox</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">color</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> color</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> _RenderColoredBox </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">RenderProxyBoxWithHitTestBehavior</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">_RenderColoredBox</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> required </span><span class="token class-name">Color</span><span class="token plain"> color </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _color </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> color</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">behavior</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">HitTestBehavior</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">opaque</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">//...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token metadata function" style="color:#d73a49">@override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">paint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">PaintingContext</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Offset</span><span class="token plain"> offset</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">size </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token class-name">Size</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">zero</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">canvas</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">drawRect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">offset </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> size</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Paint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">color </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> color</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">child </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">paintChild</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">child</span><span class="token operator" style="color:#393A34">!</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> offset</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>다시 <code>ColoredBox</code> 위젯을 확인하자 <code>ColoredBox</code> 위젯의 <code>createRenderObject</code>에서는 <code>_RenderColoredBox</code>를 생성한다. <code>_RenderColoredBox</code> 클래스의 계층을 정리하면 <code>RenderProxyBoxWithHitTestBehavior</code>를 확장하고 있는걸 볼 수 있는데, <code>RenderProxyBox</code>, <code>RenderBox</code>를 거쳐 <code>RenderObject</code> 계층을 구성하는 것을 볼 수 있다.</p>
<p><img decoding="async" loading="lazy" alt="RenderObject diagram" src="/assets/images/flutter_rendering_4-c136bc14152917b1131200229229dd32.png" width="884" height="489" class="img_ev3q"></p>
<p>이로써 드디어 <code>Widget</code>, <code>Element</code>, <code>RenderObject</code>의 계층과 의존 관계가 완성되었다.</p>
<p><code>Widget</code>, <code>Element</code>, <code>RenderObject</code>를 거치는 과정을 통해 최종적으로 페인팅 될 때는 <code>RenderObject</code>의 <code>paint</code> 메소드가 호출된다. <code>paint</code> 메소드가 호출되면   메소드의 인자로 전달된 <code>PaintingContext</code>의 <code>canvas</code>로 <code>drawRect</code> 메소드를 호출한다.</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">base </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> _NativeCanvas </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">NativeFieldWrapperClass1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">Canvas</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token metadata function" style="color:#d73a49">@override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">drawRect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Rect</span><span class="token plain"> rect</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Paint</span><span class="token plain"> paint</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">_drawRect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rect</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">left</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> rect</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">top</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> rect</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">right</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> rect</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bottom</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> paint</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_objects</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> paint</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token metadata function" style="color:#d73a49">@Native</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token class-name">Void</span><span class="token plain"> </span><span class="token class-name">Function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Pointer</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Void</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Double</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Double</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Double</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Double</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Handle</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Handle</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">symbol</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&#x27;Canvass::drawRect&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">external</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_drawRect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    double left</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> double top</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> double right</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> double bottom</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Object</span><span class="token generics operator" style="color:#393A34">?</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> paintObjects</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">ByteData</span><span class="token plain"> paintData</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><code>canvas</code>는 <code>_NativeCanvas</code>의 객체로 <code>drawRect</code>를 따라가면 <code>c++</code>로 구현된 플러터 렌더일 엔진이 최종적으로 페인팅을 하며 길고 긴 렌더링 여정을 마치게 된다.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="위젯-커스터마이징과-쉐이더를-활용한-렌더링">위젯 커스터마이징과 쉐이더를 활용한 렌더링<a href="#위젯-커스터마이징과-쉐이더를-활용한-렌더링" class="hash-link" aria-label="위젯 커스터마이징과 쉐이더를 활용한 렌더링에 대한 직접 링크" title="위젯 커스터마이징과 쉐이더를 활용한 렌더링에 대한 직접 링크">​</a></h3>
<p>이번에는 <code>ColoredBox</code>가 아닌 위젯을 커스터마이징과 쉐이더 2가지 방식을 활용해 화면을 녹색으로 칠하도록 만들며 앞서 살펴본 플러터 렌더링 과정을 되새겨보자.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="widget과-renderobject-커스터마이징">Widget과 RenderObject 커스터마이징<a href="#widget과-renderobject-커스터마이징" class="hash-link" aria-label="Widget과 RenderObject 커스터마이징에 대한 직접 링크" title="Widget과 RenderObject 커스터마이징에 대한 직접 링크">​</a></h4>
<p>자식 위젯을 가질 수 없는 간단한 위젯을 <code>Widget</code>과 <code>RenderObject</code>의 커스터마이징을 통해 구현해보자</p>
<p>먼저 <code>drawRect</code>로 주어진 영역과 색으로 화면을 칠하는 <code>RenderObject</code>를 구현해보자</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">RenderNoChildColoredBox</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">RenderBox</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">Paint</span><span class="token plain"> _paint </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Paint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">Color</span><span class="token plain"> _color</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">RenderNoChildColoredBox</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">required </span><span class="token class-name">Color</span><span class="token plain"> color</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> _color </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> color</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">color</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Color</span><span class="token plain"> newColor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_color </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> newColor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      _color </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> newColor</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">markNeedsPaint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token metadata function" style="color:#d73a49">@override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">paint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">PaintingContext</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Offset</span><span class="token plain"> offset</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">canvas</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">drawRect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">offset </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> size</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _paint</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">color </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> _color</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>유저의 입력을 처리할 필요도 없고, 자식 위젯을 통해 자식 렌더오브젝트를 렌더링할 필요도 없기 때문에 단순히 자신의 위치와 크기만 계산해 렌더링하는 <code>RenderBox</code>를 확장해 <code>RenderNoChildColoredBox</code>라는 클래스를 선언하였다.</p>
<p><code>RenderNoChildColoredBox</code> 클래스는 색상을 생성자로 받아 프로퍼티를 초기화 한다. <code>color</code>에 대한 <code>setter</code>도 구현해 외부에서 전달된 <code>color</code> 값이 프로퍼디의 값과 같은지 검사한 후, 다른 경우에만 <code>repaint</code>를 위해 <code>markNeedsPaint</code> 메소드를 호출하도록 구현한다. 이는 플러터 렌더링 최적화의 핵심 매커니즘 중 하나이므로 <code>RenderObject</code>를 직접 확장할 때 <code>martNeedsPaint</code>가 불필요하게 호출되지 않도록 해야한다.</p>
<p><code>RenderNoChildColoredBox</code>가 위젯 트리에 <code>attach</code> 되거나 <code>markNeedsPaint</code>에 의해 <code>repaint</code>할 <code>render object</code>로 등록된다면 다음 프레임에 <code>paint</code> 메소드가 호출되는데, 앞서 살펴본 <code>ColoredBox</code>의 <code>paint</code>와 마찬가지로 <code>canvas</code>의 <code>drawRect</code> 메소드를 호출해 <code>offset</code>과 <code>size</code>, <code>color</code> 속성을 이용해 화면을 칠한다.</p>
<p>이제 <code>RenderNoChildColoredBox</code>를 렌더링에 사용하는 커스텀 <code>NoChildColoredBox</code> 위젯도 구현해보자.</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">NoChildColoredBox</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">LeafRenderObjectWidget</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">Color</span><span class="token plain"> color</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token class-name">NoChildColoredBox</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> required </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">color</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token metadata function" style="color:#d73a49">@override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">RenderNoChildColoredBox</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createRenderObject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">BuildContext</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token class-name">RenderNoChildColoredBox</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">color</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> color</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token metadata function" style="color:#d73a49">@override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">updateRenderObject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">BuildContext</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">RenderNoChildColoredBox</span><span class="token plain"> renderObject</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    renderObject</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">color </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> color</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>자식 위젯을 사용하지 않는 위젯을 만들기 위해 <code>SingleChildRenderObjectWidget</code> 대신 <code>LeafRenderObjectWidget</code>을 확장한 후, 화면에 칠할 <code>Color</code> 속성을 생성자로 전달 받는다.</p>
<p><code>createRenderObject</code>를 오버라이드해 렌더링에 사용할 <code>RenderObject</code>인 <code>RenderNoChildColoredBox</code>를 생성해 반환한다.</p>
<p><code>updateRenderObject</code> 메소드를 오버라이드하며, <code>updateRenderObject</code>의 두 번째 인자는 렌더링에 사용할 <code>RenderNoChildColoredBox</code> 타입으로 선언한다. 플러터는 widget이 <code>rebuild</code> 되어도 <code>Element</code> 트리에 대한 변경이 없다면 <code>RenderObject</code>를 재사용한다.</p>
<p>이렇게 만들어진 <code>NoChildcoloredBox</code> 위젯은 <code>ColoredBox</code> 위젯과 달리 자식 위젯에 레이아웃이나 유저 입력 처리를 위한 영역 검사 등을 할 필요가 없어 화면을 칠하는데 특화된 경량 위젯이  생성되는 것이다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="custompaint와-custompainter-그리고-fragment-shader">CustomPaint와 CustomPainter 그리고 Fragment Shader<a href="#custompaint와-custompainter-그리고-fragment-shader" class="hash-link" aria-label="CustomPaint와 CustomPainter 그리고 Fragment Shader에 대한 직접 링크" title="CustomPaint와 CustomPainter 그리고 Fragment Shader에 대한 직접 링크">​</a></h4>
<p>다음으로 프래그먼트 쉐이더를 알아보자 프래그먼트 쉐이더는 <strong>GPU</strong>로 렌더링한다. 다음은 <strong>Nvidia</strong>가 2008년도에 <strong>Nvision</strong>이라는 행사에서 CPU와 GPU의 차이를 보여주기 위한 영상이다.</p>
<table><thead><tr><th>CPU</th><th>GPU</th></tr></thead><tbody><tr><td><img decoding="async" loading="lazy" alt="cpu rendering" src="/assets/images/cpu_image_rendering-1a69a1840a417ace828c3557d13301f3.gif" width="432" height="242" class="img_ev3q"></td><td><img decoding="async" loading="lazy" alt="gpu rendering" src="/assets/images/gpu_image_rendering-30a4ffd2c8aef2ce77f214ffe57714ec.gif" width="458" height="258" class="img_ev3q"></td></tr></tbody></table>
<p>영상에서 보는 방식을 프래그먼트 쉐이더의 동작방식을 잘 보여준다. 프래그먼트 쉐이더는 픽셀 쉐이더라 하는데, 화면을 구성하는 각 픽셀이 출력할 RGBA 값을 GPU를 통해 <strong>병렬</strong> 처리한다. 이러한 <code>FragmentShader</code>를 플러터에서는 <code>CustomPainter</code>로 간단히 활용할 수 있다.</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ShaderPainter</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">CustomPainter</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">Color</span><span class="token plain"> color</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">FragmentShader</span><span class="token plain"> shader</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">Paint</span><span class="token plain"> _paint </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Paint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">ShaderPainter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">required </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">color</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> required </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shader</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token metadata function" style="color:#d73a49">@override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">paint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Canvas</span><span class="token plain"> canvas</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Size</span><span class="token plain"> size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    shader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setFloat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> color</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">red</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">toDouble</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    shader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setFloat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> color</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">green</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">toDouble</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    shader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setFloat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> color</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">blue</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">toDouble</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    canvas</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">drawRedt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token class-name">Rect</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">fromLTWH</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> size</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">width</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> size</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">height</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      _paint</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shader </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> shader</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token metadata function" style="color:#d73a49">@override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  bool </span><span class="token function" style="color:#d73a49">shouldRepaint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">ShaderPainter</span><span class="token plain"> oldDelegate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    color </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> olddelegate</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">color </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> shader </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> oldDelegate</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shader</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><code>CustomPainter</code>를 확장해 <code>_ShaderPainter</code> 클래스를 선언한다. <code>Color</code>와 <code>FragmentShader</code>를 선언하고 생성자로 전달받아 초기화한다. <code>FragmentShader</code> 객체를 생성하는 과정은 잠시 뒤에 살펴보자.</p>
<p><code>CustomPainter</code>의 <code>paint</code> 메소드를 오버라이드 한다. <code>paint</code> 메소드에는 <code>FragmentShader</code>의 <code>setFloat</code> <code>0, 1, 2</code> 인덱스로 <code>color</code> 속성의 <code>red, green, blue</code> 값을 전달한다. 여기에서 사용된 인덱스는 <code>FragmentShader</code> 스크립트에 매핑될 값의 인덱스를 의미하는데 이 역시 잠시 후 <code>Fragment Shader</code> 스크립트를 자세히 살펴볼 때 알아보자.</p>
<p>이제 화면을 칠하기 위해 <code>paint</code> 메소드로 전달된 <code>canvas</code> 객체로 <code>drawRect</code> 메소드를 호출하고, <code>Paint</code> 객체의 <code>shader</code>에 화면을 칠할 때 사용할 <code>fragment shader</code> 객체를 전달한다.</p>
<p><code>shouldRepaint</code>도 오버라이드 한다. <code>CustomPainter</code> 사용 시 최적화를 위해 중요한 메소드로 <code>rebuild</code>에 의해 새롭게 생성된 <code>CustomPainter</code>의 속성과 <code>shouldRepaint</code>의 인자로 전달된 이전 <code>CustomPainter</code>의 속성을 비교해 상태가 변경된 경우에만 <code>repaint</code>가 되도록 이전 상태와 비교 후 <code>true</code> 혹은 <code>false</code>를 반환하도록 구현한다.</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">FutureBuilder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  future</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">FragmentProgram</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">fromAsset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-literal string" style="color:#e3116c">&#x27;assets/shaders/helloworld.frag&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  builder</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> snapshot</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> fragmentProgram </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> snapshot</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fragmentProgram </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token class-name">CustomPaint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        painter</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">ShaderPainter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          color</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> color</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          shader</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> fragmentProgram</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">fragmentShader</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token class-name">Center</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">child</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">CircularProgressIndicator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p><code>CustomPainter</code>를 확장한 <code>ShaderPainter</code> 객체를 <code>CustomPaint</code>의 <code>painter</code>로 전달한다.</p>
<p><code>helloworld.frag</code>라는 쉐이더 파일을 <code>FragmentProgram.fromAsset</code>으로 쉐이더 파일을 비동기로 로드한 뒤, 로드가 완료되면 <code>fragmentShader</code> 메소드를 호출 해 <code>fragmentProgram</code>으로 변환한 뒤 <code>ShaderPainter</code>에 전달한다.</p>
<p><code>helloworld.frag</code>를 살펴보자</p>
<div class="language-frag codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-frag codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#version 460 core                       // OpenGL 버전(4.6)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#include &lt;flutter/runtime_effect.glsl&gt;  // 플러터 사전 구현된 코드 추가</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uniform float r;                        // 쉐이더 외부에 전달 받을 값</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uniform float g;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uniform float b;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">out vec4 FragColor;                     // 쉐이더 출력값</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void main() {                           // 프래그먼트 쉐이더 함수</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  FragColor = vec4(r, g, b, 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>```helloworld.frag<code>쉐이더는 확장자에서 알 수 있듯 프래그먼트 쉐이더이다. 프래그먼트 쉐이더 상단에는 **OpenGL** 버전을 명시하고</code>include<code>로 플러터 엔진에 사전 구현된 코드를 사용하기 위해 추가한다. </code>include`를 통해 다양한 픽셀 색상 연산에 다양한 유틸 함수나 상수를 사용할 수 있게된다.</p>
<p><code>uniform</code>으로 3개의 <code>float</code> 변수 <code>r, g, b</code>를 선언 했는데 <code>uniform</code>으로 변수를 선언하면 쉐이더 외부에서 인덱스를 통해 값을 전달할 수 있게된다.</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token metadata function" style="color:#d73a49">@override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">paint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Canvas</span><span class="token plain"> canvas</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Size</span><span class="token plain"> size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  shader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setFloat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> color</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">red</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">toDouble</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  shader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setFloat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> color</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">green</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">toDouble</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  shader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setFloat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> color</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">blue</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">toDouble</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  canvas</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">drawRect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Rect</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">fromLTWH</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> size</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">width</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> size</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">height</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _paint</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shader </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> shader</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>앞서 쉐이더를 사용한 <code>paint</code> 메소드에서 <code>setFloat</code>를 호출하며 <code>0, 1, 2</code> 인덱스와 함께 전달한 값이 프래그먼트 쉐이더의 <code>uniform</code> 변수에 전달되는 것이다.</p>
<p><code>out</code>으로 선언한 변수는 <code>uniform</code>과 반대로 출력값이며, <code>vec4</code>로 <code>rgba</code> 색상을 표현한다.</p>
<p><code>main</code>은 프래그먼트 쉐이더 함수의 진입점이다. <code>main</code> 함수에서는 <code>uniform</code>으로 전달된 값을 <code>vec4</code>에 담아 출력값을 만드는 간단한 쉐이더로 구성된 것을 볼 수 있다. 이상 단순히 외부에서 전달한 값을 출력값으로 만드는 예제였다.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="렌더링-최적화">렌더링 최적화<a href="#렌더링-최적화" class="hash-link" aria-label="렌더링 최적화에 대한 직접 링크" title="렌더링 최적화에 대한 직접 링크">​</a></h3>
<p><code>widget</code>, <code>element</code>, <code>renderobject</code>를 통해 랜더링되는 과정을 살펴보았고, <code>widget</code>과 <code>renderObject</code>를 커스터마이징해보기도 하고 custom paint, painter, fragment shader를 활용해 화면을 칠하는 방법을 살펴보았다.</p>
<p>플러터팀에서는 16ms 이내 build, 16ms paint를 처리하도록 가이드한다. 단일 위젯의 build와 paint가 아닌 한 프레임에 처리하는 모든 위젯과 렌더오브젝트의 build와 paint를 각 각 16ms에 처리해야한다는 것이다. 영상이나 게임, 모바일 운영체제의 fps가 60프레임을 지원하며 유저의 눈높이는 보다 높아졌다. 랙이 없는 부드러운 애니메이션을 위해서는 60fps를 유지해야하는데, 이를 위해서는 상태 변경에 따라 rebuild, repaint 되는 모든 위젯과 렌더오브젝트가 매 프레임마다 각 각 8ms 이내 처리되어야함을 의미한다.</p>
<p>8ms의 paint를 위해 <code>shouldRepaint</code>에서 화면을 다시 그릴지 여부를 반환하고 <code>markNeedsPaint</code>에서 화면을 다시 그리도록 예약하는 로직의 어떤 공통점이 렌더링을 최적화해줄까? 공통점은 단순하다 <strong>그리지 않기</strong> 컴포넌트를 분리하고 리빌드 되는 컴포넌트를 격 리해 리빌드 되는 위젯을 최소화하고 위젯 트리에 단순하게 구성하고 필요에 따라 컴포지션이 아닌 위젯을 직접 만들고 렌더링 과정에서 살펴본 상태 비교 조건 처리 후 <code>repaint</code> 여부 검사를 하는 등의 모든 과정들이 모두 그리지 않기 위한 전략을 통해 최적화를 하고 있는 것 이다.</p>
<p>그리지 않는 단순한 전략을 기억하고, 우리 모두가 고품질의 렌더링을 제공하는 앱을 개발하는 플러터 전문가로 나아가자.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="flutter-web을-활용하여-제품-개발-환경-개선하기">Flutter web을 활용하여 제품 개발 환경 개선하기<a href="#flutter-web을-활용하여-제품-개발-환경-개선하기" class="hash-link" aria-label="Flutter web을 활용하여 제품 개발 환경 개선하기에 대한 직접 링크" title="Flutter web을 활용하여 제품 개발 환경 개선하기에 대한 직접 링크">​</a></h2>
<p>라인 데마에칸 서비스를 플러터 환경으로 전환하며 겪었던 문제점들 중 테스트 환경과 관련하여 고민해본 내용을 공유해주었다. 동료들이 테스트 환경에 더 적극적으로 찹여할 수 있도록 하기위해 테스트 -&gt; 피드백 -&gt; 개선 사이클을 최소화 하기위한 방안을 고민하였으며, 이를 웹 배포를 통해 어떻게 해결하였는지 공유해주는 시간이었다.</p>
<p>이를 참고하여 Web FrontEnd에서 많이 활용중인 Storybook과 유사한 Widgetbook과 Static Web 사이트 배포를 통해 현재 회사에서도 테스트 환경을 개선하여 디자이너와 기획자 동료분들로 부터 지속적이고 즉각적인 피드백을 받을 수 있는 환경을 구성할 수 있는 계기가 되었다.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="왜-flutter-web인가">왜 Flutter Web인가?<a href="#왜-flutter-web인가" class="hash-link" aria-label="왜 Flutter Web인가?에 대한 직접 링크" title="왜 Flutter Web인가?에 대한 직접 링크">​</a></h3>
<p>테스트 환경을 제공해주기 위해서는 여러 방법이 있을 것이다. 기존에는 SDK 파일로 컴파일하여 실제 디바이스에 실행가능한 상태로 제공해주는 방법을 많이 활용하였다. 하지만 이렇게 제공해주게 된다면 사람들은 본능적으로 최대한 한번에 보여주기 위해 노력하므로, 기능들이 어느정도 누적되었을 때 공유하기를 원한다. 따라서 디자이너나 기획자가 수정사항을 확인할 때에도 너무 많은 기능들이 포함 되어있어, 꼼꼼하게 기능들을 모두 확인하기는 어렵다.</p>
<p>프로그래밍에 있어서도 이러한 문제점을 개선하기 위해 현재 많은 기업들에서 지속적인 배포를 지향하고 있다. 테스트에도 이러한 문제점을 개선하기 위해 지속적으로 테스트 환경을 업데이트해줄 필요가 있다.</p>
<p>이번 발표에서 말하는 Web 배포의 핵심 요소는 아래의 3가지이다.</p>
<ul>
<li>앱 제품 개선 과정 효율화</li>
<li>물리적 제약사항 극복</li>
<li>프로덕션 수준으로 서비스를 출시하려 노력하지 않아도 됨</li>
</ul>
<p>우선, 앱 제품을 개선하기 위해 의사소통 과정을 효율화 하여야 한다. 이는 처음에 말했듯 지속적 개발과 연관되어 있다. 다음으로는 물리적 제약사항을 극복하기 위함이다. 라인의 경우 일본, 동남아 등 여러 나라에서 기획자들과 디자이너들이 근무하고 있어 디바이스에 프로그램을 직접 배포하여 전달해주기에는 물리적으로 힘들다. 따라서 특정 디바이스가 필요 없는 웹을 통해 공유하는 방법을 생각했다. 마지막으로 테스트 환경은 실제 프로덕션 수준으로 서비스를 출시하지 않아도 된다. 테스트 환경은 말그대로 테스트를 위한 환경, 우리의 서비스가 정상적으로 동작하는지를 확인하기 위한 것으로 실제 서비스와 동일한 수준으로 만들지 않아도 된다. 이 부분을 핵심 요소로 꼽은 이유는 모바일 디바이스 환경과 Web 브라우저 환경의 차이 때문이다. 대표적으로 모바일 디바이스의 경우 세션 스토리지, 쿠키를 설정할 수 없으므로 모두 디바이스 로컬 메모리에 저장하거나 Secure memory에 저장해주게 된다. 이러한 코드를 웹에서 그대로 실행하려면 문제가 발생하므로 만약, 웹에서도 프로덕션 수준으로 배포를 하여야한다면 문제가 된다. 하지만 우리는 테스트 환경을 화면이 어떻게 구성되는지, 기능들이 정상적으로 상호작용 하는지만 보기 위함이므로 이러한 요소들은 우회하여도 된다.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web-빌드-및-배포-시도-사례">Web 빌드 및 배포 시도 사례<a href="#web-빌드-및-배포-시도-사례" class="hash-link" aria-label="Web 빌드 및 배포 시도 사례에 대한 직접 링크" title="Web 빌드 및 배포 시도 사례에 대한 직접 링크">​</a></h3>
<p>그렇다면 Web 빌드 시 발생하는 문제점들과 이를 해결하는 방법에는 어떤 것들이 있을까? 라인 데마에칸 시스템에서 실제로 시도한 과정에서 발생한 문제점들과 이를 해결한 방법들을 통해 대표적인 문제점들을 살펴보자</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="unsupported-operation-platform_operatingsystem">Unsupported operation: Platform._operatingSystem<a href="#unsupported-operation-platform_operatingsystem" class="hash-link" aria-label="Unsupported operation: Platform._operatingSystem에 대한 직접 링크" title="Unsupported operation: Platform._operatingSystem에 대한 직접 링크">​</a></h4>
<p>플랫폼 분기를 위해 사용중인 <code>Platform.isAndroid, Platform.isIOS</code> 코드에서 발생하는 오류이다.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Error: Unsupported operation: Platform._operatingSystem</span><br></span></code></pre></div></div>
<p>Andoid, iOS 등 멀티플랫폼 환경을 제공하는 서비스라면 플랫폼 분기가 반드시 필요하다. 하지만 이렇게 특정 플랫폼만을 위한 코드를 작성하게 되면 어떤 플랫폼에도 속하지 않는 웹 브라우저 환경에서는 에러가 발생한다. 이를 해결하기 위해 해당 팀에서는 <code>defaultTargetPlatform</code>을 활용하여 플랫폼 분기 코드에 대응하도록 수정하였다.</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&#x27;dart:io&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&#x27;package:flutter/foundation.dart&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">PlatformUtils</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> bool </span><span class="token keyword" style="color:#00009f">get</span><span class="token plain"> isWeb </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> kIsWeb</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> bool </span><span class="token keyword" style="color:#00009f">get</span><span class="token plain"> isAndroid </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> defaultTargetPlatform </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token class-name">TargetPlatform</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">android</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> bool </span><span class="token keyword" style="color:#00009f">get</span><span class="token plain"> isIOS </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> defaultTargetPlatForm </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token class-name">TargetPlatform</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">iOS</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">get</span><span class="token plain"> localeName </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> isWeb </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&quot;ja_JP&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Platform</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">localeName</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="as-is">AS-IS<a href="#as-is" class="hash-link" aria-label="AS-IS에 대한 직접 링크" title="AS-IS에 대한 직접 링크">​</a></h5>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">showInfoDialog</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Platform</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isIOS</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">showActionSheet</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">showSystemDialog</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="to-be">TO-BE<a href="#to-be" class="hash-link" aria-label="TO-BE에 대한 직접 링크" title="TO-BE에 대한 직접 링크">​</a></h5>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">showInfoDialog</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">PlatformUtils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isIOS</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">showActionSheet</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">showSystemDialog</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>위와 같이 <code>PlatformUtils</code> 라는 클래스를 생성하여 <code>Platform</code>을 래핑하고 <code>DefaultPlatform</code>을 추가하여 <code>Platform</code>이 예상하는 값과 다를 때 처리하는 구문을 추가해주었다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="h3_flutter-package-update">h3_flutter package update<a href="#h3_flutter-package-update" class="hash-link" aria-label="h3_flutter package update에 대한 직접 링크" title="h3_flutter package update에 대한 직접 링크">​</a></h4>
<p>특정 패키지들의 경우 버전이나 종속성으로 인한 문제로 에러가 발생할 수 있을 것이다. 발표자료에서는 Uber에서 개발한 지구 계층을 육각형 그리드로 매핑해놓은 패키지에서 에러가 발생하여 설명해주었다.
h3_flutter 0.4.2를 사용할 때 에러가 발생하였고 0.6.6 버전 이후부터 웹을 지원하였지만 Android에서 빌드 오류가 발생하여 이슈 리포트를 통해 이를 수정하도록 요청하여 문제를 해결하였다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="unsupported-operation-trying-to-use-the-default-webview">Unsupported operation: Trying to use the default webview<a href="#unsupported-operation-trying-to-use-the-default-webview" class="hash-link" aria-label="Unsupported operation: Trying to use the default webview에 대한 직접 링크" title="Unsupported operation: Trying to use the default webview에 대한 직접 링크">​</a></h4>
<p>개인정보 취급방침, 이용약관, 공지사항 등 WebView 화면에서 오류가 발생하였다. <code>webview_flutter: ^3.0.4</code> 를 사용 시 웹에서 빌드를 하면 에러가 발생한다. 이를 <code>webview_flutter_web: ^0.1.0+4</code>를 추가하여 해결하였다. 웹뷰 위젯 구현부를 <strong>조건부 임포트</strong>를 활용하여 실행가능한 패키지로 실행되도록 해준 것이다.</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&#x27;package:flutter/material.dart&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&#x27;package:driver_app/ui/lib/widget/webview_app.dart&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dart</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">library</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">html</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&#x27;package:driver_app/ui/lib/widget/webview_web.dart&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">SimpleWebView</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">StatelessWidget</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token class-name">MyApp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token metadata function" style="color:#d73a49">@override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">Widget</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">build</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">BuildContext</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token class-name">WebViewImpl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="flutter_secure_storage---domexception">flutter_secure_storage - DomException<a href="#flutter_secure_storage---domexception" class="hash-link" aria-label="flutter_secure_storage - DomException에 대한 직접 링크" title="flutter_secure_storage - DomException에 대한 직접 링크">​</a></h4>
<p>데이터를 암호화하여 저장하기 위해 사용하는 패키지이다. 특정 데이터를 읽어오는 경우 <strong>DomException</strong>이 발생한다.</p>
<p>키가 <code>{category}::{keyName}</code> 형식인 경우 이슈가 발행하여 <code>{keyName}</code> 형식으로 수정해주면 해결된다.</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/// Encrypts and saves the [key] with the given [value].</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/// If the key was aleady in the storage, its associated value is changed.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/// If the value is null, deletes associated value for the given [key].</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token metadata function" style="color:#d73a49">@override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Future</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">String</span><span class="token generics operator" style="color:#393A34">?</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  required </span><span class="token class-name">String</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  required </span><span class="token class-name">Map</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">String</span><span class="token generics punctuation" style="color:#393A34">,</span><span class="token generics"> </span><span class="token generics class-name">String</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> value </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> web</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">localStorage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-literal string" style="color:#e3116c">&quot;</span><span class="token string-literal interpolation punctuation" style="color:#393A34">${</span><span class="token string-literal interpolation expression">options</span><span class="token string-literal interpolation expression punctuation" style="color:#393A34">[</span><span class="token string-literal interpolation expression">_publicKey</span><span class="token string-literal interpolation expression punctuation" style="color:#393A34">]</span><span class="token string-literal interpolation expression operator" style="color:#393A34">!</span><span class="token string-literal interpolation punctuation" style="color:#393A34">}</span><span class="token string-literal string" style="color:#e3116c">.</span><span class="token string-literal interpolation punctuation" style="color:#393A34">$</span><span class="token string-literal interpolation expression">key</span><span class="token string-literal string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_decryptValue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="xmlhttprequest-error">XMLHttpRequest error<a href="#xmlhttprequest-error" class="hash-link" aria-label="XMLHttpRequest error에 대한 직접 링크" title="XMLHttpRequest error에 대한 직접 링크">​</a></h4>
<p>웹에서 API 통신을 시도할 경우 오류가 발생한다. <strong>CORS (Cross-Origin Resource Sharing) issue</strong></p>
<p><strong>로컬 개발 환경</strong>에서 chrome 실행 시 <code>--disable-web-security</code>를 설정하여 대응하였다.</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="set---disable-web-security-options">Set <code>--disable-web-security</code> options<a href="#set---disable-web-security-options" class="hash-link" aria-label="set---disable-web-security-options에 대한 직접 링크" title="set---disable-web-security-options에 대한 직접 링크">​</a></h5>
<ol>
<li><code>flutter/bin/cache</code> 이동 후 <code>flutter_tools.stamp</code>를 제거한다.</li>
<li><code>flutter/package/flutter_tools/lib/src/web/chrome.dart</code> 파일을 연다.</li>
<li><code>--disable-web-security</code> 옵션을 추가한다.</li>
</ol>
<p><strong>로컬 개발 환경</strong>에서 chrome 실행 시 보안 설정을 수정한다. 실제 배포 환경에서 수정하지 않도록 주의 한다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="cross-origin-resource-sharing-cors">Cross-Origin Resource Sharing (CORS)<a href="#cross-origin-resource-sharing-cors" class="hash-link" aria-label="Cross-Origin Resource Sharing (CORS)에 대한 직접 링크" title="Cross-Origin Resource Sharing (CORS)에 대한 직접 링크">​</a></h4>
<p>Cross-Origin Resource Sharing (CORS) 란? <strong>브라우저</strong>가 <strong>자신의 출처(Origin)가 아닌 다른 출처로부터 자원 로드를 허용</strong>하도록 서버가 허가해주는 HTTP 헤더 기반의 메커니즘으로 출처가 다른 서버간의 리소스 공유를 허용하는 것이다.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Origin(출처)란?</div><div class="admonitionContent_BuS1"><p>URL (Uniform Resource Location) 구조에서 <strong>Protocol + Host + Port</strong> 부분을 의미한다.</p><p><code>https://future-flutter.dev:8080/sessions/detail?page=3#flutter_web</code></p><p><code>https://</code>: Protocol</p><p><code>future-flutter.dev</code>: Host</p><p><code>:8080</code>: Port</p><p><code>/sessions/detail</code>: Path</p><p><code>?page=3</code> Query String</p><p><code>#flutter_web</code>: Fragment</p></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="cors---flow-of-preflight-request-case">CORS - flow of preflight request case<a href="#cors---flow-of-preflight-request-case" class="hash-link" aria-label="CORS - flow of preflight request case에 대한 직접 링크" title="CORS - flow of preflight request case에 대한 직접 링크">​</a></h5>
<p><img decoding="async" loading="lazy" alt="CORS flow" src="/assets/images/flutter_web_1-3a5a752257a924b65aa0179a4098aa98.png" width="1207" height="433" class="img_ev3q"></p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="enabling---disable-web-secure">Enabling --disable-web-secure<a href="#enabling---disable-web-secure" class="hash-link" aria-label="Enabling --disable-web-secure에 대한 직접 링크" title="Enabling --disable-web-secure에 대한 직접 링크">​</a></h5>
<p><img decoding="async" loading="lazy" alt="Enabling" src="/assets/images/flutter_web_2-dd29c3588a210a53597bbba93fe16d57.png" width="1231" height="489" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="tip-use-flutter_cors-tools">(Tip) use <code>flutter_cors</code> tools<a href="#tip-use-flutter_cors-tools" class="hash-link" aria-label="tip-use-flutter_cors-tools에 대한 직접 링크" title="tip-use-flutter_cors-tools에 대한 직접 링크">​</a></h4>
<p>여러 버전의 flutter SDK 를 사용할 경우 유용하다.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// install &#x27;flutter_cors&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ dart pub global activate flutter_cors</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// disable chrome web security option</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ fluttercors -d -p {flutter_sdk_path}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// enable chrome web security option</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ fluttercors -e -p {flutter_sdk_path}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="permission-acquisition-scenario-reviewing">Permission acquisition scenario (reviewing)<a href="#permission-acquisition-scenario-reviewing" class="hash-link" aria-label="Permission acquisition scenario (reviewing)에 대한 직접 링크" title="Permission acquisition scenario (reviewing)에 대한 직접 링크">​</a></h4>
<p>권한획득 시나리오의 경우도 너무 복잡하여 웹에서 대응하기 어려웠다고 한다.</p>
<table><thead><tr><th>Android</th><th>iOS</th></tr></thead><tbody><tr><td><img decoding="async" loading="lazy" alt="Android Permission" src="/assets/images/flutter_web_3-9349b37fcb63a5de4cd58f57d1c6f630.png" width="567" height="322" class="img_ev3q"></td><td><img decoding="async" loading="lazy" alt="iOS Permission" src="/assets/images/flutter_web_4-3de01abe193a6d9e89e77494e7583bf3.png" width="568" height="324" class="img_ev3q"></td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="web-support-platform-not-available-reviewing">Web support platform not available (reviewing)<a href="#web-support-platform-not-available-reviewing" class="hash-link" aria-label="Web support platform not available (reviewing)에 대한 직접 링크" title="Web support platform not available (reviewing)에 대한 직접 링크">​</a></h4>
<p>웹을 미지원 하는 패키지로 인한 이슈도 있다.</p>
<p>해당 팀에서 개발 당시 기기 의존적인 기능들이 많았는데 당시에는 그러한 패키지들이 거의 없어 특히 <strong>웹에서 지도를 표현</strong> 하는 문제가 가장 컸다고 한다.</p>
<p>이러한 부분들은 최근 많은 패키지들이 웹에서도 지원되도록 개선되어 어느정도 해소되었다.</p>
<p><img decoding="async" loading="lazy" alt="Web Update" src="/assets/images/flutter_web_5-5f1df9dab8f1c7aec5a0da8cefd4f6b6.png" width="1201" height="510" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="드라이버-앱의-웹-시도-결과">드라이버 앱의 웹 시도 결과<a href="#드라이버-앱의-웹-시도-결과" class="hash-link" aria-label="드라이버 앱의 웹 시도 결과에 대한 직접 링크" title="드라이버 앱의 웹 시도 결과에 대한 직접 링크">​</a></h4>
<p>Flutter web 빌드 및 로컬 개발환경까지 준비가 되었지만 웹 환경에서 드라이버 앱을 사용 가능한 수준까지 진행하는 못하였다.</p>
<p>하지만 이 때의 경험을 살려 추후 Flutter Web 과제를 진행하는데 큰 도움이 되었다고 한다.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="두-번째-flutter-web-시도">두 번째 Flutter web 시도<a href="#두-번째-flutter-web-시도" class="hash-link" aria-label="두 번째 Flutter web 시도에 대한 직접 링크" title="두 번째 Flutter web 시도에 대한 직접 링크">​</a></h3>
<p>Recode &amp; UI/UX 리뉴얼 과제 를 진행하며 다시 Flutter web을 시도하였다.</p>
<p>UI/UX를 리뉴얼 하는 과정에서 제품 개선과정의 동기화가 쉽지 않다고 느꼈는데 재택근무로 인한 물리적 제약사항, 기획자 및 관계자들을 위한 앱의 동작 테스트 수단 필요 등을 이유로 Flutter Web 활용을 다시 시도한다.</p>
<p>이전의 Flutter Web 시도 경험을 바탕으로 PoC를 진행하고 컨슈머 앱을 웹에서 확인 가능한 환경을 제공하여 앱 동작을 확인할 수 있는 수단을 제공하려 하였다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="consumerapp-웹-버전의-목표가-아닌-것">ConsumerApp 웹 버전의 목표가 아닌 것<a href="#consumerapp-웹-버전의-목표가-아닌-것" class="hash-link" aria-label="ConsumerApp 웹 버전의 목표가 아닌 것에 대한 직접 링크" title="ConsumerApp 웹 버전의 목표가 아닌 것에 대한 직접 링크">​</a></h4>
<p>위 과정에서 불필요한 부분은 배제하고 필요한 기능만을 개발하는 것이 가장 중요하였는데 이때 선정한 불필요한 항목은 다음과 같다.</p>
<ul>
<li>기존 웹 서비스를 대체하는 것</li>
<li>모바일 기기와 완전히 동일하게 동작하는 것</li>
<li>업무 프로세스에 최적화 하는 것</li>
</ul>
<p>이러한 요소들을 제외하고 해당 팀에서 Flutter 를 활용한 웹 개발 시 겪었던 문제들과 해결 방법을 공유해주었다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="unsupported-operation-platform_operatingsystem-1">Unsupported operation: Platform._operatingSystem<a href="#unsupported-operation-platform_operatingsystem-1" class="hash-link" aria-label="Unsupported operation: Platform._operatingSystem에 대한 직접 링크" title="Unsupported operation: Platform._operatingSystem에 대한 직접 링크">​</a></h4>
<p>플랫폼 분기를 위해 사용중인 <code>Platform.isAndroid</code>, <code>Platform.isIOS</code> 코드에서 오류가 발생한다.</p>
<p>이전과 같이 <code>defaultTargetPlatform</code>을 사용하여 플랫폼 분기 코드에 대응한다. 이 때 추가로 <code>CustomLint</code>를 추가해주어 기본 분기코드를 사용하지 않도록 방지하는 방법도 공유해주었다.</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="use-custom_lint-package">Use custom_lint package<a href="#use-custom_lint-package" class="hash-link" aria-label="Use custom_lint package에 대한 직접 링크" title="Use custom_lint package에 대한 직접 링크">​</a></h5>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> _UsePlatformHelperLintRules </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">DartLintRule</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_UsePlatformHelperLintRules</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">code</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> _code</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">/// Metadata about the warning that will show-up in the IDE.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">/// This is used for `// ignore: code` and enabling/disabing the lint</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> _code </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">LintCode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&#x27;use_platformhelper_instead&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    problemMessage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&quot;&#x27;Platform.{0}&#x27; should not be used&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    correctionMessage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&quot;Use &#x27;PlatformHelper.{0}&#x27; instead&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    errorSeverity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">ErrorSeverity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ERROR</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token metadata function" style="color:#d73a49">@override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">CustomLintResolver</span><span class="token plain"> resolver</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">ErrorReporter</span><span class="token plain"> reporter</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">CustomLintContext</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/// The addPrefixedIdentifier checks the grammar of the [xxx].[xxx] format to forward the callback as node.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">registry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">addPrefixedIdentifier</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">node</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> beginToken </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> node</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">beginToken</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> endToken </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> node</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">endToken</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">beginToken</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">value</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">toString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&#x27;Platform&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> endToken</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">value</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">toString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&#x27;isAndroid&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> beginToken</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">value</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">toString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&#x27;Platform&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> endToken</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">value</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">toString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&#x27;isIOS&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">/// Report a lint error.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        reporter</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">reportErrorForNode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">code</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> node</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">endToken</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">value</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">toString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="update-packages">Update packages<a href="#update-packages" class="hash-link" aria-label="Update packages에 대한 직접 링크" title="Update packages에 대한 직접 링크">​</a></h4>
<p>웹 빌드 시 패키지 내부에서도 오류가 발생한다. 참조 패키지에서 <code>dart:ffi</code> import 중 오류가 발생하여 확인하자 이후 해당 오류를 수정한 버전이 올라와 있었다고 한다.</p>
<p>Flutter Web 도 출시된지 어느정도 시간이 지나 대부분의 패키지에서는 수정된듯 하다.</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="newrelic_mobile-101">newrelic_mobile: 1.0.1<a href="#newrelic_mobile-101" class="hash-link" aria-label="newrelic_mobile: 1.0.1에 대한 직접 링크" title="newrelic_mobile: 1.0.1에 대한 직접 링크">​</a></h5>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Launching lib/main.dart on Chrome in debug mode...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">main.dart:1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">: Error: Dart library &#x27;dart:ffi&#x27; is not available on this platform.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">newrelic_mobile.dart:7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import &#x27;dart:ffi&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// highlight-start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Context: The unavailable library &#x27;dart:ffi&#x27; is imported through these packages:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">web_entrypoint.dart =&gt; package:consumer_app =&gt; package:newrelic_mobile =&gt; dart:ffi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// highlight-end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Detailed import paths for (some of) the these imports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Failed to compile application.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Exited</span><br></span></code></pre></div></div>
<p><code>dart:ffi</code> 패키지의 경우 웹에서는 사용할 수 없다. 따라서 해당 패키지를 사용하는 <code>newrelic_mobile</code> 1.0.1 버전을 사용하면 위 에러가 발생하는데, 다음과 같이 1.0.3 버전 이후 해당 부분이 수정된 것을 볼 수 있다.</p>
<p><a href="https://github.com/newrelic/newrelic-flutter-agent/commit/2690bc968ba1833bbf80618f19bafc1bc70840c4" target="_blank" rel="noopener noreferrer">Commit log</a></p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Added &#x27;import dart:ffi&#x27; at (1.0.1)</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&#x27;dart:async&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&#x27;dart:ffi&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&#x27;dart:io&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">show</span><span class="token plain"> </span><span class="token class-name">HttpOverrides</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Platform</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&#x27;package:flutter/foundation.dart&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p><a href="https://github.com/newrelic/newrelic-flutter-agent/commit/017416eb6bede3de86319807ab52568a91223063" target="_blank" rel="noopener noreferrer">Commit log</a></p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Removed &#x27;import dart:ffi&#x27; at (1.0.3)</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&#x27;dart:async&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&#x27;dart:ffi&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&#x27;dart:io&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">show</span><span class="token plain"> </span><span class="token class-name">HttpOverrides</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Platform</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&#x27;package:flutter/foundation.dart&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="support-web-platform">Support web platform<a href="#support-web-platform" class="hash-link" aria-label="Support web platform에 대한 직접 링크" title="Support web platform에 대한 직접 링크">​</a></h4>
<ul>
<li><strong>flutter_inappwebview: 6.0.0</strong>: 웹 실행 시 오류 발생</li>
<li><strong>fpjs_pro_flugin: ^3.0.0</strong>: 전화번호 인증 flow 에서 오류 발생</li>
</ul>
<p>위 두 패키지의 경우 웹에서 실행 시 오류가 발생하였고 각각 <code>index.html</code>에 <code>web_support.js</code>, <code>index.js</code>를 추가해주어 해결했다.</p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- ... --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">application/javascript</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">/assets/packages/flutter_inappwebview_web/web_support.js</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">defer</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">assets/packages/fpjs_pro_plugin/web/index.js</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">defer</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="do-not-use-package-when-run-on-web">Do not use package when run on web<a href="#do-not-use-package-when-run-on-web" class="hash-link" aria-label="Do not use package when run on web에 대한 직접 링크" title="Do not use package when run on web에 대한 직접 링크">​</a></h4>
<p>웹 환경에서는 앱의 기능을 제공할 수 없는 패키지들도 있다. 이러한 패키지들은 의도적으로 웹 환경에서는 미지원 하도록 처리가 필요하다.</p>
<p>해당 기능을 위해 플랫폼 별 다른 구현체를 반환하는 패턴으로 수정하여 패키지 인터페이스를 직접 사용하지 못하도록 Custom Lint 를 추가하여 해결하  였다.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">main.dart 문제 2개 중 1개</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;FlutterAppBadger.***&#x27; should not be used</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Use &#x27;$appBadger.***&#x27; instead dart(use_app_badger)</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="case-of-fluuter_app_badger-usage">Case of fluuter_app_badger usage<a href="#case-of-fluuter_app_badger-usage" class="hash-link" aria-label="Case of fluuter_app_badger usage에 대한 직접 링크" title="Case of fluuter_app_badger usage에 대한 직접 링크">​</a></h5>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">app_badger.dart</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">AppBadger</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">get</span><span class="token plain"> $appBadger </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token class-name">PlatformHelper</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isWeb </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_AppBadgerWeb</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_AppBadgerImpl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">abstract</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">AppBadger</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">Future</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics keyword" style="color:#00009f">void</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">updateBadgeCount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">int count</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">Future</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics keyword" style="color:#00009f">void</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">removeBadge</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// AS-IS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">FlutterAppBadger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">updateBadgeCount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">count</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// TO-BE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$appBadger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">updateBadgeCount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">count</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">app_badger_impl.dart</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">part</span><span class="token plain"> of </span><span class="token string-literal string" style="color:#e3116c">&#x27;app_badger.dart&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> _AppBadgerImpl </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">AppBadger</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token metadata function" style="color:#d73a49">@override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">Future</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics keyword" style="color:#00009f">void</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">removeBadge</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token class-name">FlutterAppBadger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">removeBadge</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token metadata function" style="color:#d73a49">@override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">Future</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics keyword" style="color:#00009f">void</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">updateBadgeCount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">int count</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token class-name">FlutterAppBadger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">updateBadgeCount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">count</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">app_badger_web.dart</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">part</span><span class="token plain"> of </span><span class="token string-literal string" style="color:#e3116c">&#x27;app_badger.dart&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> _AppBadgerWeb </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">AppBadger</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token metadata function" style="color:#d73a49">@override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">Future</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics keyword" style="color:#00009f">void</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">removeBadge</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">debugPrint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-literal string" style="color:#e3116c">&#x27;AppBadger &gt;&gt; removeBadge&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token class-name">Future</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">value</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token metadata function" style="color:#d73a49">@override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">Future</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics keyword" style="color:#00009f">void</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">updateBadgeCount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">int count</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">debugPrint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-literal string" style="color:#e3116c">&#x27;AppBadger &gt;&gt; updateBadgeCount(</span><span class="token string-literal interpolation punctuation" style="color:#393A34">$</span><span class="token string-literal interpolation expression">count</span><span class="token string-literal string" style="color:#e3116c">)&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token class-name">Future</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">value</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="-getter-pattern">$ getter pattern<a href="#-getter-pattern" class="hash-link" aria-label="$ getter pattern에 대한 직접 링크" title="$ getter pattern에 대한 직접 링크">​</a></h5>
<p>플랫폼 별 다른 기능을 제공하는 경우 $ getter 형식을 사용하는 것으로 정리하였다.</p>
<table><thead><tr><th>Package Name</th><th>AS-IS</th><th>TO-BE</th><th>Support Custom Lint</th></tr></thead><tbody><tr><td>adjust_sdk</td><td>Adjust.***</td><td>$adjustUtil.***</td><td>O</td></tr><tr><td>newrelic_mobile</td><td>NewrelicMobile.***</td><td>$newrelicUtil.***</td><td>O</td></tr><tr><td>flutter_inappwebview</td><td>ChromeSafariBrowser()</td><td>$chromeSafariBrowser</td><td>O</td></tr><tr><td>flutter_app_badger</td><td>FlutterAppBadger.***</td><td>$appBadger.***</td><td>O</td></tr><tr><td>firebase_core</td><td>Firebase.***</td><td>FirebaseUtil.***</td><td>X</td></tr><tr><td>firebase_analytics</td><td>FirebaseAnalytics.instance.***</td><td>$firebaseAnalytics.***</td><td>O</td></tr><tr><td>firebase_auth</td><td>FirebaseAuth.instance.***</td><td>$firebaseAuth.***</td><td>O</td></tr><tr><td>firebase_crashlytics</td><td>FirebaseCrashlytics.instance.***</td><td>$firebaseCrashlytics.***</td><td>O</td></tr><tr><td>firebase_messaging</td><td>FirebaseMessaging.instance.***</td><td>$firebaseMessaging.***</td><td>O</td></tr><tr><td>firebase_remote_config</td><td>FirebaseRemoteConfig.instance.***</td><td>$firebaseRemoteConfig.***</td><td>O</td></tr><tr><td>rokt_sdk</td><td>RoktSdk.***</td><td>$roktSdkUtil.***</td><td>X</td></tr></tbody></table>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="support-mapview">Support MapView<a href="#support-mapview" class="hash-link" aria-label="Support MapView에 대한 직접 링크" title="Support MapView에 대한 직접 링크">​</a></h5>
<p><strong>platform_maps_flutter: ^1.0.2</strong> 패키지를 사용하여 지도를 표시하여 주었는데, 해당 패키지의 경우 <code>iOS - AppleMapView / Android - GoogleMapView</code>를 사용하도록 개발되었기 때문에 웹에서는 별도의 처리가 필요하다.</p>
<p>이를 웹에서는 <code>google_maps_flutter</code>를 이용해 맵뷰가 표시되도록 개선하였다.</p>
<p><strong>In platform_maps_flutter</strong></p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> _PlatformMapState </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">State</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">PlatformMap</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token metadata function" style="color:#d73a49">@override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">Widget</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">build</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">BuildContext</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Platform</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isAndroid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Platform</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isIOS</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><strong>Refactor MapView</strong></p>
<p>앱에서는 <code>platform_maps_flutter</code> / 웹에서는 <code>google_maps_flutter</code> 로 맵뷰</p>
<p><img decoding="async" loading="lazy" alt="Refactor MapView" src="/assets/images/flutter_web_6-6462593457a015dbe56ab399c79e7a94.png" width="1654" height="462" class="img_ev3q"></p>
<p><strong>Add Google Maps JavaScript API</strong></p>
<p><code>index.html</code>에 <strong>Google Maps JavaScript API</strong> 추가</p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">head</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- Other stuff --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">head</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<p>위 방법대로 적용을 하면 로컬 개발환경에서는 <code>ReferrerNotAllowedMapError</code>가 발생한다. 하지만 배포 환경에서는 정상적으로 동작한다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="build-web">Build web<a href="#build-web" class="hash-link" aria-label="Build web에 대한 직접 링크" title="Build web에 대한 직접 링크">​</a></h4>
<p><code>--base-href</code> 설정을 할 경우 <code>web_support.js</code> 경로 오류가 발생한다. 빌드 완료 후 <code>index.html</code> 파일을 수정하는 스크립트를 작성하여 이를 해결하였다.</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Work-around: `flutter_inappwebview_web` doesn&#x27;t support `--base-href` option.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Therefore, the script replaces a javascript path in `index.html`.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// If the library supports that, we can remove below work-around.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> htmlPath </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-literal string" style="color:#e3116c">&#x27;./build/web/index.html&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> originalHtml </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Deno</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">readTextFileSync</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">htmlPath</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> replacedHtml </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> originalHtml</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">replaceAll</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-literal string" style="color:#e3116c">&#x27;/assets/packages/flutter_inappwebview_web/assets/web/web_support.js&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-literal string" style="color:#e3116c">&#x27;assets/packages/flutter_inappwebview_web/assets/web/web_support.js&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Deno</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">writeTextFileSync</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">htmlPath</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> replacedHtml</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="web-rendering-option-changed">Web rendering option changed<a href="#web-rendering-option-changed" class="hash-link" aria-label="Web rendering option changed에 대한 직접 링크" title="Web rendering option changed에 대한 직접 링크">​</a></h4>
<p>build web <strong>--web-renderer</strong> 기본값이 <code>auto</code>에서 <code>canvaskit</code>로 변경되었다. 또 <code>SDK 3.22</code> 부터는 <code>--wasm</code>도 사용가능하다(chrome만 지원). 이에 맞춰서 <code>build</code> 옵션을 설정해줄 수 있다.</p>
<table><thead><tr><th>AS-IS</th><th>TO-BE</th></tr></thead><tbody><tr><td><strong>--web-renderer {value}</strong><br><br><code>auto</code> - 모바일 브라우저에서는 <code>html</code>, 데스크탑 브라우저에서는 <code>canvaskit</code>으로 동작<br><code>html</code> - 경량적, 웹 표준기술을 사용(하지만 제대로 동작하지 않는 기능이 많음)<br><code>canvaskit</code> - 고품질 그래픽, 일관된 렌더링</td><td><strong>--wasm</strong><br><br>브라우저가 <code>wasm</code>을 지원할 경우 <code>wasm</code>, 아닐 경우 <code>canvaski</code>으로 동작<br>이 옵션을 설정하지 않을 경우 <code>canvaskit</code>으로 동작<br><br><code>flutter build web -help</code> 로 옵션 지원여부 확인 가능</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-to-web">Deploy to web<a href="#deploy-to-web" class="hash-link" aria-label="Deploy to web에 대한 직접 링크" title="Deploy to web에 대한 직접 링크">​</a></h4>
<p>AWS S3로 static page 배포를 진행하였다. 배포 진행시 아래와 같이 CORS issue가 발생하는데, 해당 발표자분은 인프라팀에 요  청을 하여 이슈를 해결하였지만 현재 회사에서 유사하게 <code>Widgetbook</code>을 활용한 <code>Widget visual test</code> 환경을 구축 중에 동일한 이슈를 해결중이라. 추후 이에 대한 글도 작성할 예정이다.</p>
<p><strong>CORS issue</strong></p>
<ul>
<li>BFF (API Server)</li>
<li>Image Server</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="컨슈머-앱의-웹-시도-결과">컨슈머 앱의 웹 시도 결과<a href="#컨슈머-앱의-웹-시도-결과" class="hash-link" aria-label="컨슈머 앱의 웹 시도 결과에 대한 직접 링크" title="컨슈머 앱의 웹 시도 결과에 대한 직접 링크">​</a></h3>
<p>라인에서는 이렇게 웹 배포를 적용하여 다음과 같이 팀 내부에서 활용 중이다.</p>
<ul>
<li>과제별 개발 진행상황 확인</li>
<li>앱 제품에 대한 접근성 대폭 개선</li>
<li>주문 ~ 배달 완료 주문 흐름 테스트가 편해짐</li>
</ul>
<p>위 경험들을 통해 <strong>동료를 유저로 확장하는 경험</strong>을 할 수 있었다.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="세-번째-flutter-web-시도">세 번째 Flutter web 시도<a href="#세-번째-flutter-web-시도" class="hash-link" aria-label="세 번째 Flutter web 시도에 대한 직접 링크" title="세 번째 Flutter web 시도에 대한 직접 링크">​</a></h3>
<p>위 경험을 바탕으로 리테일 앱도 웹 빌드 및 배포를 진행하게 된다. 리테일 앱이란 <strong>Y!Shopping (LINEヤフー &amp; Demae-can)</strong> 서비스로 매장에서 주문을 수주하고 주문을 배달로 연계하는 서비스이다.</p>
<p>QA 팀에서 웹으로 배포를 요청하여 진행하게 되었고 개발 과정에서 어떻게 활용하였는지 사례를 소개해주었다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="web-build--deploy-when-pull-request-created">Web build &amp; deploy when Pull-Request created.<a href="#web-build--deploy-when-pull-request-created" class="hash-link" aria-label="Web build &amp; deploy when Pull-Request created.에 대한 직접 링크" title="Web build &amp; deploy when Pull-Request created.에 대한 직접 링크">​</a></h4>
<p>PR 생성 시, 작업 내용을 실제로 확인하기 위해 Flutter Web 내부 배포를 실행하였다.</p>
<ul>
<li><code>flutter analyze</code>, <code>flutter test</code>, <code>spell check</code> 등 실행</li>
<li>플랫폼 별 빌드 실행 &lt; <strong>Web 빌드 시 배포 수행</strong></li>
<li>테스트 실행 결과 및 Web 빌드 결과 확인 URL을 PR Comment 추가</li>
<li>매일 업로드된 버킷 목록과 PR 목록을 확인하여 자동으로 클라우드 저장소에 업로드된 웹 빌드물 삭제</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-to-web-1">Deploy to web<a href="#deploy-to-web-1" class="hash-link" aria-label="Deploy to web에 대한 직접 링크" title="Deploy to web에 대한 직접 링크">​</a></h4>
<p>Verda cloud로 배포해주었고 마찬가지로 CORS 이슈가 발생하여 이를 인프라팀에 요청하여 해결한다.</p>
<p><strong>CORS issue</strong></p>
<ul>
<li>CORS header issue</li>
<li>CORS preflight issue</li>
</ul>
<p>BFF (API Server) 이슈 수정으로 대응</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="flutter-app-을-web-으로-활용-시-고려할-사항">Flutter app 을 web 으로 활용 시 고려할 사항<a href="#flutter-app-을-web-으로-활용-시-고려할-사항" class="hash-link" aria-label="Flutter app 을 web 으로 활용 시 고려할 사항에 대한 직접 링크" title="Flutter app 을 web 으로 활용 시 고려할 사항에 대한 직접 링크">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="do-not-use-platform">Do not use Platform.***<a href="#do-not-use-platform" class="hash-link" aria-label="Do not use Platform.***에 대한 직접 링크" title="Do not use Platform.***에 대한 직접 링크">​</a></h4>
<p><code>Platform.isAndroid</code>, <code>Platform.isIOS</code>를 사용 하지 않기</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Error: Unsupported operation: Platform._operatingSystem</span><br></span></code></pre></div></div>
<p><a href="#unsupported-operation-platform_operatingsystem">Unsupported operation: Platform._operatingSystem</a>에서 본 것과 같이 <strong>defaultTargetPlatform</strong> class를 생성하여 추가적인이 필요합니다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="consider-each-package-using-within-the-app">Consider each package using within the app<a href="#consider-each-package-using-within-the-app" class="hash-link" aria-label="Consider each package using within the app에 대한 직접 링크" title="Consider each package using within the app에 대한 직접 링크">​</a></h4>
<ol>
<li>
<p>웹에서 오류가 발생하는 지 확인한다.</p>
<p>로컬 개발환경에서 우선 확인</p>
<p>패키지 추가 시, 웹 환경 설정을 누락했을 가능성이 높다.</p>
</li>
<li>
<p>관련 <strong>기능이 반드시 필요한지 확인</strong>한다.</p>
<p>패키지가 웹을 지원하는지 확인하고, 가급적 지원하도록 대응하자.</p>
<p>(생각보다 많은) 패키지가 웹 환경을 지원한다.</p>
<p>만약 웹을 지원하지 않을 경우, <strong>Mock 활용을 고려</strong>하자.</p>
<p>패키지를 업데이트 했으면, 모바일 환경에서 한번 더 체크한다.</p>
</li>
<li>
<p>반대로, <strong>굳이 필요하지 않은지 판단</strong>한다.</p>
<p>관련 기능을 웹환경에서 의도적으로 제공하지 않는다.</p>
<p>인터페이스 호출 시 플랫폼별로 다르게 동작하도록 구성한다.</p>
<p>앱과 웹 의 실행 환경은 다르다는 것을 항상 염두한다.</p>
</li>
<li>
<p>웹에서 <strong>제약사항을 잘 공유</strong>한다.</p>
<p>기술적으로 지원이 불가능한 경우가 있을 수 있다.</p>
<p>앱과 동작이 완벽히 동일하지 않을 수 있다.</p>
<p>브라우저 쿠키 &amp; 캐시 제거 방법을 공유하자</p>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="cross-origin-resource-sharing-cors-">Cross-Origin Resource Sharing (CORS) ?<a href="#cross-origin-resource-sharing-cors-" class="hash-link" aria-label="Cross-Origin Resource Sharing (CORS) ?에 대한 직접 링크" title="Cross-Origin Resource Sharing (CORS) ?에 대한 직접 링크">​</a></h4>
<p><strong>브라우저</strong>가 <strong>자신의 출처(Origin)가 아닌 다른 출처로부터 자원 로드를 허용</strong>하도록 서버가 허가해주는 HTTP 헤더 기반의 메커니즘 <code>출처가 다른 서버간의 리소스 공유를 허용하는 것</code></p>
<table><thead><tr><th>Origin(출처)?</th><th>-</th></tr></thead><tbody><tr><td>URL (Uniform Resource Location) 구조에서<br> <strong>Protocol + Host + Port</strong></td><td><img decoding="async" loading="lazy" alt="URL 구조" src="/assets/images/flutter_web_7-c6b1a0264ae3ab30c4ae9ade127e02a8.png" width="1149" height="202" class="img_ev3q"></td></tr></tbody></table>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="enabling---disable-web-secure-1">Enabling --disable-web-secure<a href="#enabling---disable-web-secure-1" class="hash-link" aria-label="Enabling --disable-web-secure에 대한 직접 링크" title="Enabling --disable-web-secure에 대한 직접 링크">​</a></h5>
<p><img decoding="async" loading="lazy" alt="disable web secure" src="/assets/images/flutter_web_2-dd29c3588a210a53597bbba93fe16d57.png" width="1231" height="489" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="server-side-configuration">Server-Side configuration<a href="#server-side-configuration" class="hash-link" aria-label="Server-Side configuration에 대한 직접 링크" title="Server-Side configuration에 대한 직접 링크">​</a></h4>
<p><strong>XMLHttpRequest, unauthorized 200 응답과 함께 데이터가 없는 현상 등</strong></p>
<p>배포된 웹에서의 접근 허용 작업 요청</p>
<ul>
<li>DevOps Engineer</li>
<li>Server Engineer</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="use-proxy-server">Use Proxy Server<a href="#use-proxy-server" class="hash-link" aria-label="Use Proxy Server에 대한 직접 링크" title="Use Proxy Server에 대한 직접 링크">​</a></h4>
<p>만약 웹 서비스도 운영 중이면, proxy server 가 존재할 가능성이 높다</p>
<p><img decoding="async" loading="lazy" alt="with proxy server" src="/assets/images/flutter_web_8-feb38fddc82aa111d24719514d2aa21a.png" width="1786" height="495" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>참고 자료</div><div class="admonitionContent_BuS1"><p>Flutter Web 을 활용해 제품 개발 환경 개선하기 with Future Flutter 2024</p><p><a href="https://youtu.be/By9k4vZ__Mk" target="_blank" rel="noopener noreferrer">Flutter 엔지니어로 직무 전환한 이야기</a></p><p><a href="https://engineering.linecorp.com/ko/blog/demaecan-2nd-recode-kmm-to-flutter" target="_blank" rel="noopener noreferrer">멀쩡한 앱을 Flutter 앱으로 다시 짠이유– 일본 1위 배달앱, 두 번째 Recode</a></p><p><a href="https://www.uber.com/en-KR/blog/h3/" target="_blank" rel="noopener noreferrer">H3: Uber-s Hexagonal Hierarchical Spatial Index</a></p><p><a href="https://medium.com/flutter-community/conditional-imports-across-flutter-and-web-4b88885a886e" target="_blank" rel="noopener noreferrer">Conditional imports across Flutter and Web</a></p><p><a href="https://developer.mozilla.org/ko/docs/Web/API/Window/localStorage" target="_blank" rel="noopener noreferrer">Window.localStorage</a></p><p><a href="https://github.com/cfug/dio/issues/750" target="_blank" rel="noopener noreferrer">Flutter Web – XMLHttpRequest error</a></p><p><a href="https://stackoverflow.com/questions/65630743/how-to-solve-flutter-web-api-cors-error-onlywith-dart-code/66879350#66879350" target="_blank" rel="noopener noreferrer">How to solve flutter web api cors error only with dart code?</a></p><p><a href="https://pub.dev/packages/flutter_cors" target="_blank" rel="noopener noreferrer">flutter_cors</a></p><p><a href="https://techblog.lycorp.co.jp/ko/demaecan-3rd-recode-react-native-to-flutter" target="_blank" rel="noopener noreferrer">Flutter 전환의 마침표 – 일본 1위 배달 앱, 세 번째 Recode</a></p><p><a href="https://www.expertappdevs.com/blog/flutter-web-vs-react-native-web" target="_blank" rel="noopener noreferrer">Flutter Web or React Native Web: Who Will Win the Battle?</a></p><p><a href="https://techblog.lycorp.co.jp/ko/using-custom-lint-in-flutter" target="_blank" rel="noopener noreferrer">Flutter에서 커스텀 린트 활용하기</a></p><p><a href="https://inappwebview.dev/blog/flutter-inappwebview-6#web-support" target="_blank" rel="noopener noreferrer">Flutter InAppWebView 6 &gt; Web Support</a></p><p><a href="https://pub.dev/packages/fpjs_pro_plugin#web-platform" target="_blank" rel="noopener noreferrer">Fingerprint Pro Flutter &gt; web support</a></p><p><a href="https://pub.dev/packages/google_maps_flutter_web#usage" target="_blank" rel="noopener noreferrer">google_maps_flutter_web &gt; usage</a></p><p><a href="https://developers.google.com/maps/documentation/javascript/error-messages#referer-not-allowed-map-error" target="_blank" rel="noopener noreferrer">Google Maps Platform &gt; RefererNotAllowedMapError</a></p><p><a href="https://docs.google.com/document/d/1DGamHsa2lz_Qtgfrfa3j3fRaEopJXc7tCFVM1TQlck8" target="_blank" rel="noopener noreferrer">Intent to deprecate and remove the HTML renderer in Flutter Web</a></p><p><a href="https://techblog.lycorp.co.jp/ko/improve-development-experience-with-flutter-web" target="_blank" rel="noopener noreferrer">Flutter Web을 활용해 제품 개발 환경 개선하기</a></p><p><a href="https://developer.mozilla.org/ko/docs/Web/HTTP/CORS" target="_blank" rel="noopener noreferrer">교차 출처 리소스 공유 (CORS)</a></p><p><a href="https://www.popit.kr/cors-preflight-%EC%9D%B8%EC%A6%9D-%EC%B2%98%EB%A6%AC%EA%B4%80%EB%A0%A8-%EC%82%BD%EC%A7%88/" target="_blank" rel="noopener noreferrer">CORS, Preflight, 인증 처리 관련 삽질</a></p><p><a href="https://velog.io/@ojwman/spring-boot-cors-header-preflight" target="_blank" rel="noopener noreferrer">SpringBoot에서 CORS할 때 header, preflight 이슈 해결하기</a></p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="어느날-갑자기-앱이-터졌을-때">어느날 갑자기 앱이 터졌을 때<a href="#어느날-갑자기-앱이-터졌을-때" class="hash-link" aria-label="어느날 갑자기 앱이 터졌을 때에 대한 직접 링크" title="어느날 갑자기 앱이 터졌을 때에 대한 직접 링크">​</a></h2>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="flutter-bloc을-제품-개발에-야무지게-적용하기">Flutter Bloc을 제품 개발에 야무지게 적용하기<a href="#flutter-bloc을-제품-개발에-야무지게-적용하기" class="hash-link" aria-label="Flutter Bloc을 제품 개발에 야무지게 적용하기에 대한 직접 링크" title="Flutter Bloc을 제품 개발에   야무지게 적용하기에 대한 직접 링크">​</a></h2></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>태그:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/dart">Dart</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/flutter">Flutter</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/app">app</a></li></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><a href="https://github.com/mooyeon-choi/mooyeon-choi.github.io/tree/master/blog/2024-10-29-future-flutter-conf.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>페이지 편집</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="블로그 게시물 탐색"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2024-kwdc"><div class="pagination-nav__sublabel">이전 게시물</div><div class="pagination-nav__label">2024 KWDC 톺아보기</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/apply-storybook"><div class="pagination-nav__sublabel">다음 게시물</div><div class="pagination-nav__label">스토리북 적용기</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#소개" class="table-of-contents__link toc-highlight">소개</a></li><li><a href="#ffi로-연결하는-고go와-플러터" class="table-of-contents__link toc-highlight">FFI로 연결하는 고(Go)와 플러터</a><ul><li><a href="#왜-go-인가" class="table-of-contents__link toc-highlight">왜 Go 인가?</a></li><li><a href="#왜-플러터인가" class="table-of-contents__link toc-highlight">왜 플러터인가?</a></li><li><a href="#ffi-란" class="table-of-contents__link toc-highlight">FFI 란?</a></li><li><a href="#플러터에서-ffi-사용하기" class="table-of-contents__link toc-highlight">플러터에서 FFI 사용하기</a></li><li><a href="#플러터에서-사용하기" class="table-of-contents__link toc-highlight">플러터에서 사용하기</a></li><li><a href="#정리" class="table-of-contents__link toc-highlight">정리</a></li></ul></li><li><a href="#flutter-webrtc" class="table-of-contents__link toc-highlight">Flutter WebRTC</a><ul><li><a href="#서론" class="table-of-contents__link toc-highlight">서론</a></li><li><a href="#webrtc의-주요-개념" class="table-of-contents__link toc-highlight">WebRTC의 주요 개념</a></li><li><a href="#webrtc-관련-flutter-패키지" class="table-of-contents__link toc-highlight">WebRTC 관련 Flutter 패키지</a></li><li><a href="#webrtc--websocket-동작흐름" class="table-of-contents__link toc-highlight">WebRTC &amp; WebSocket 동작흐름</a></li><li><a href="#flutter-webrtc를-위한-팁" class="table-of-contents__link toc-highlight">Flutter WebRTC를 위한 팁</a></li></ul></li><li><a href="#shorebird-작동-방식" class="table-of-contents__link toc-highlight">ShoreBird 작동 방식</a><ul><li><a href="#code-push란" class="table-of-contents__link toc-highlight">Code push란?</a></li></ul></li><li><a href="#풍성한-디자인-요청사항에-대응하기" class="table-of-contents__link toc-highlight">풍성한 디자인 요청사항에 대응하기</a><ul><li><a href="#custompaint를-활용한-container" class="table-of-contents__link toc-highlight">CustomPaint를 활용한 Container</a></li><li><a href="#loading-skeleton" class="table-of-contents__link toc-highlight">Loading Skeleton</a></li><li><a href="#customscrollview--dropdown" class="table-of-contents__link toc-highlight">CustomScrollView + Dropdown</a></li><li><a href="#디자이너와-소통하기" class="table-of-contents__link toc-highlight">디자이너와 소통하기</a></li></ul></li><li><a href="#플러터-렌더링-해부학" class="table-of-contents__link toc-highlight">플러터 렌더링 해부학</a><ul><li><a href="#랜더링-과정" class="table-of-contents__link toc-highlight">랜더링 과정</a></li><li><a href="#위젯-커스터마이징과-쉐이더를-활용한-렌더링" class="table-of-contents__link toc-highlight">위젯 커스터마이징과 쉐이더를 활용한 렌더링</a></li><li><a href="#렌더링-최적화" class="table-of-contents__link toc-highlight">렌더링 최적화</a></li></ul></li><li><a href="#flutter-web을-활용하여-제품-개발-환경-개선하기" class="table-of-contents__link toc-highlight">Flutter web을 활용하여 제품 개발 환경 개선하기</a><ul><li><a href="#왜-flutter-web인가" class="table-of-contents__link toc-highlight">왜 Flutter Web인가?</a></li><li><a href="#web-빌드-및-배포-시도-사례" class="table-of-contents__link toc-highlight">Web 빌드 및 배포 시도 사례</a></li><li><a href="#두-번째-flutter-web-시도" class="table-of-contents__link toc-highlight">두 번째 Flutter web 시도</a></li><li><a href="#컨슈머-앱의-웹-시도-결과" class="table-of-contents__link toc-highlight">컨슈머 앱의 웹 시도 결과</a></li><li><a href="#세-번째-flutter-web-시도" class="table-of-contents__link toc-highlight">세 번째 Flutter web 시도</a></li><li><a href="#flutter-app-을-web-으로-활용-시-고려할-사항" class="table-of-contents__link toc-highlight">Flutter app 을 web 으로 활용 시 고려할 사항</a></li></ul></li><li><a href="#어느날-갑자기-앱이-터졌을-때" class="table-of-contents__link toc-highlight">어느날 갑자기 앱이 터졌을 때</a></li><li><a href="#flutter-bloc을-제품-개발에-야무지게-적용  하기" class="table-of-contents__link toc-highlight">Flutter Bloc을 제품 개발에 야무지게 적용하기</a></li></ul></div></div></div></div></div></div>
</body>
</html>