<!doctype html>
<html lang="ko" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">애플리케이션을 백그라운드에서 동작시키기 위한 방법 | Mylog</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mooyeon-choi.github.io/blog/how-to-run-application-on-background"><meta data-rh="true" property="og:locale" content="ko"><meta data-rh="true" name="docusaurus_locale" content="ko"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="ko"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="애플리케이션을 백그라운드에서 동작시키기 위한 방법 | Mylog"><meta data-rh="true" name="description" content="소개"><meta data-rh="true" property="og:description" content="소개"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-12-12T15:12:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/mooyeon-choi"><meta data-rh="true" property="article:tag" content="flutter,iOS,swift,android"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://mooyeon-choi.github.io/blog/how-to-run-application-on-background"><link data-rh="true" rel="alternate" href="https://mooyeon-choi.github.io/blog/how-to-run-application-on-background" hreflang="ko"><link data-rh="true" rel="alternate" href="https://mooyeon-choi.github.io/blog/how-to-run-application-on-background" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://mooyeon-choi.github.io/blog/how-to-run-application-on-background","mainEntityOfPage":"https://mooyeon-choi.github.io/blog/how-to-run-application-on-background","url":"https://mooyeon-choi.github.io/blog/how-to-run-application-on-background","headline":"애플리케이션을 백그라운드에서 동작시키기 위한 방법","name":"애플리케이션을 백그라운드에서 동작시키기 위한 방법","description":"소개","datePublished":"2024-12-12T15:12:00.000Z","author":{"@type":"Person","name":"Mooyeon Choi","url":"https://github.com/mooyeon-choi","image":"https://github.com/mooyeon-choi.png"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://mooyeon-choi.github.io/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Mylog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Mylog Atom Feed">




<script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/5.1.3/pixi.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/webfont/1.6.28/webfontloader.js"></script><link rel="stylesheet" href="/assets/css/styles.7fe4c1a2.css">
<script src="/assets/js/runtime~main.0e0f288c.js" defer="defer"></script>
<script src="/assets/js/main.65301e70.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="본문으로 건너뛰기"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">본문으로 건너뛰기</a></div><nav aria-label="메인" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="사이드바 펼치거나 접기" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Mylog</b></a><a class="navbar__item navbar__link" href="/docs/intro">개발 공부</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">기록</a><a class="navbar__item navbar__link" href="/showcase">Showcase</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://evanescent-table-194.notion.site/Frontend-0866085aac3c4c619efbd9ab1d940329" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Resume<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://open.kakao.com/o/sEenYDXg" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">CoffeeChat<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://github.com/mooyeon-choi" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="어두운 모드와 밝은 모드 전환하기 (현재 system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="최근 블로그 문서 둘러보기"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025-kwdc">2025 KWDC 톺아보기</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/feconf2025">FECONF2025 톺아보기</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/onnx-on-web">Onnx web runtime 구축하기 with Vite</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/eslint-with-tailwindcss">왜 eslint-plugin-tailwindcss 를 버리고 eslint-plugin-better-tailwindcss 를 새로 개발하였을까?</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/service-worker">Web Service Worker로 파일 업로드 분리하기</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">애플리케이션을 백그라운드에서 동작시키기 위한 방법</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-12-12T15:12:00.000Z">2024년 12월 12일</time></div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/mooyeon-choi" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://github.com/mooyeon-choi.png" alt="Mooyeon Choi"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/mooyeon-choi" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Mooyeon Choi</span></a></div><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="소개">소개<a href="#소개" class="hash-link" aria-label="소개에 대한 직접 링크" title="소개에 대한 직접 링크">​</a></h2>
<p>애플리케이션을 개발하다보면 대용량 파일 업로드/다운로드 주기적인 데이터 fetch 작업 등 애플리케이션에서 백그라운드로 동작을 해줘야하는 상황들이 있다. 이러한 백그라운드 프로세스 작업들의 경우 어떤 식으로 실행할 수 있으며 어떻게 유지할 수 있는지 iOS/Android 각각의 환경에서 알아본 내용이다.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>목차</div><div class="admonitionContent_BuS1"><ol>
<li><a href="#%EC%95%88%EB%93%9C%EB%A1%9C%EC%9D%B4%EB%93%9C%EC%97%90%EC%84%9C%EC%9D%98-%EB%B0%B1%EA%B7%B8%EB%9D%BC%EC%9A%B4%EB%93%9C-%EC%9E%91%EC%97%85">안드로이드에서의 백그라운드 작업</a></li>
<li><a href="#ios%EC%97%90%EC%84%9C%EC%9D%98-%EB%B0%B1%EA%B7%B8%EB%9D%BC%EC%9A%B4%EB%93%9C-%EC%9E%91%EC%97%85">iOS에서의 백그라운드 작업</a></li>
<li><a href="#%ED%94%8C%EB%9F%AC%ED%84%B0%EC%97%90-%EC%97%B0%EA%B2%B0%ED%95%98%EA%B8%B0">플러터에 연결하기</a></li>
</ol></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="안드로이드에서의-백그라운드-작업">안드로이드에서의 백그라운드 작업<a href="#안드로이드에서의-백그라운드-작업" class="hash-link" aria-label="안드로이드에서의 백그라운드 작업에 대한 직접 링크" title="안드로이드에서의 백그라운드 작업에 대한 직접 링크">​</a></h2>
<p>안드로이드에서의 지속적인 작업은 WorkManager를 통해 처리가능하다. 대부분의 백그라운드 처리가 지속적 작업을 통해 수행되기 때문에 WorkManager는 일반적으로 백그라운드 처리를 위한 주요 권장 API로 사용된다.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="지속적인-작업의-유형">지속적인 작업의 유형<a href="#지속적인-작업의-유형" class="hash-link" aria-label="지속적인 작업의 유형에 대한 직접 링크" title="지속적인 작업의 유형에 대한 직접 링크">​</a></h3>
<p>WorkManager는 세 가지 유형의 지속적인 작업을 처리한다.</p>
<ul>
<li><strong>즉시(Immediate)</strong>: 즉시 시작해서 곧 완료해야 하는 작업</li>
<li><strong>오래 걸리는 작업(Long Running)</strong>: 10분 이상 소요되는 작업</li>
<li><strong>예약 작업(Deferrable)</strong>: 나중에 시작되거나 주기적으로 실행되는 예약된 작업</li>
</ul>
<p>아래 그림은 다양한 유형의 지속적 작업이 서로 어떻게 연관되어 있는지 간략히 설명한다.</p>
<p><img decoding="async" loading="lazy" alt="workmanager_main" src="/assets/images/workmanager_main-dde6d1ff0f8b5d2154574f268d8ec06d.svg" width="960" height="540" class="img_ev3q">
지속적인 작업 유형(<a href="https://developer.android.com/develop/background-work/background-tasks/persistent" target="_blank" rel="noopener noreferrer">https://developer.android.com/develop/background-work/background-tasks/persistent</a>)</p>
<p>마찬가지로, 다음 표에서는 다양한 유형의 작업을 간략히 설명한다.</p>
<table><thead><tr><th>유형</th><th>주기</th><th>접근방법</th></tr></thead><tbody><tr><td>즉각적인</td><td>일회성</td><td><code>OneTimeWorkRequest</code>, <code>Worker</code> 사용, 즉시 처리해야할 경우 <code>OneTimeWorkRequest</code>에서 <code>setExpedited()</code> 호출</td></tr><tr><td>오래 걸리는 작업</td><td>한번 또는 주기적으로</td><td><code>WorkRequest</code>, <code>Worker</code> 사용, 알림 처리를 위해서는 <code>setForeground()</code> 호출</td></tr><tr><td>예약 작업</td><td>한번 또는 주기적으로</td><td><code>PeriodicWorkRequest</code>, <code>Worker</code> 사용</td></tr></tbody></table>
<p>WorkManager를 설정하는 방법에 대한 자세한 내용은 <a href="https://developer.android.com/topic/libraries/architecture/workmanager/how-to/define-work?_gl=1*12i8vjd*_up*MQ..*_ga*Nzg3NTIxNDM3LjE3MzQzMTkyNTc.*_ga_6HH9YJMN9M*MTczNDMxOTI1Ni4xLjAuMTczNDMxOTI1Ni4wLjAuMTExNTE5NzcxNQ..#work-constraints" target="_blank" rel="noopener noreferrer">WorkRequest 정의</a> 가이드에서 확인할 수 있다.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="workmanager-기능">WorkManager 기능<a href="#workmanager-기능" class="hash-link" aria-label="WorkManager 기능에 대한 직접 링크" title="WorkManager 기능에 대한 직접 링크">​</a></h3>
<p>WorkManager는 더 간단하고 일관된 API를 제공하는 것 외에도 여러 가지 주요 이점을 제공한다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="작업-제약">작업 제약<a href="#작업-제약" class="hash-link" aria-label="작업 제약에 대한 직접 링크" title="작업 제약에 대한 직접 링크">​</a></h4>
<p><a href="https://developer.android.com/topic/libraries/architecture/workmanager/how-to/define-work?_gl=1*16egi7j*_up*MQ..*_ga*Nzg3NTIxNDM3LjE3MzQzMTkyNTc.*_ga_6HH9YJMN9M*MTczNDMxOTI1Ni4xLjAuMTczNDMxOTI1Ni4wLjAuMTExNTE5NzcxNQ..#work-constraints" target="_blank" rel="noopener noreferrer">작업 제약 조건</a>을 사용하여 작업을 실행하기 위한 최적의 조건을 선언적으로 정의한다. 예를 들어, 장치가 무제한 네트워크에 있을 때, 장치가 유휴 상태일 때 또는 베터리가 충분할 때만 실행한다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="강력한-스케줄링">강력한 스케줄링<a href="#강력한-스케줄링" class="hash-link" aria-label="강력한 스케줄링에 대한 직접 링크" title="강력한 스케줄링에 대한 직접 링크">​</a></h4>
<p>WorkManager를 사용하면 <a href="https://developer.android.com/topic/libraries/architecture/workmanager/how-to/define-work?_gl=1*13c2q6w*_up*MQ..*_ga*Nzg3NTIxNDM3LjE3MzQzMTkyNTc.*_ga_6HH9YJMN9M*MTczNDMxOTI1Ni4xLjAuMTczNDMxOTI1Ni4wLjAuMTExNTE5NzcxNQ.." target="_blank" rel="noopener noreferrer">유연한 스케줄링</a>창을 사용하여 작업을 <a href="https://developer.android.com/reference/androidx/work/OneTimeWorkRequest?_gl=1*5iktiz*_up*MQ..*_ga*MTQ1MDI1MDM4NC4xNzM0MzkxNDMz*_ga_6HH9YJMN9M*MTczNDM5MTQzMy4xLjAuMTczNDM5MTQzMy4wLjAuMjEzODYzMDMwMA.." target="_blank" rel="noopener noreferrer">한 번</a> 또는 <a href="https://developer.android.com/reference/androidx/work/PeriodicWorkRequest?_gl=1*5iktiz*_up*MQ..*_ga*MTQ1MDI1MDM4NC4xNzM0MzkxNDMz*_ga_6HH9YJMN9M*MTczNDM5MTQzMy4xLjAuMTczNDM5MTQzMy4wLjAuMjEzODYzMDMwMA.." target="_blank" rel="noopener noreferrer">반복적</a>으로 실행하도록 스케줄링 할 수 있다. 작업에는 태그를 지정하고 이름을 지정할 수도 있으므로 고유하고 대체 가능한 작업을 스케줄링하고 작업 그룹을 함께 모니터링하거나 취소할 수 있다.</p>
<p>예약된 작업은 내부적으로 관리되는 SQLite 데이터베이스에 저장되고 WorkManager는 장치가 재부팅되어도 이 작업을 지속하고 다시 예약되도록 보장한다.</p>
<p>또한 WorkManager는 <a href="https://developer.android.com/training/monitoring-device-state/doze-standby?_gl=1*15kdla1*_up*MQ..*_ga*MTQ1MDI1MDM4NC4xNzM0MzkxNDMz*_ga_6HH9YJMN9M*MTczNDM5MTQzMy4xLjAuMTczNDM5MTQzMy4wLjAuMjEzODYzMDMwMA.." target="_blank" rel="noopener noreferrer">Doze 모드</a>와 같은 절전 기능과 모범 사례를 준수하므로 이에 대해 걱정할 필요가 없다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="신속한-작업">신속한 작업<a href="#신속한-작업" class="hash-link" aria-label="신속한 작업에 대한 직접 링크" title="신속한 작업에 대한 직접 링크">​</a></h4>
<p>WorkManager를 사용하면 백그라운드에서 실행하기 위해 즉각적인 작업을 예약할 수 있다. 사용자에게 중요하고 몇 분 안에 완료되는 작업에는 <a href="https://developer.android.com/topic/libraries/architecture/workmanager/how-to/define-work?_gl=1*1dcvv91*_up*MQ..*_ga*MTQ1MDI1MDM4NC4xNzM0MzkxNDMz*_ga_6HH9YJMN9M*MTczNDM5MTQzMy4xLjAuMTczNDM5MTQzMy4wLjAuMjEzODYzMDMwMA..#expedited" target="_blank" rel="noopener noreferrer">Expedited 작업</a>을 사용해야한다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="유연한-재시도-정책">유연한 재시도 정책<a href="#유연한-재시도-정책" class="hash-link" aria-label="유연한 재시도 정책에 대한 직접 링크" title="유연한 재시도 정책에 대한 직접 링크">​</a></h4>
<p>작업이 실패하는 경우도 있을 것이다. WorkManager는 구성 가능한 <a href="https://developer.android.com/reference/androidx/work/BackoffPolicy?_gl=1*1vet3n8*_up*MQ..*_ga*MTQ1MDI1MDM4NC4xNzM0MzkxNDMz*_ga_6HH9YJMN9M*MTczNDM5MTQzMy4xLjAuMTczNDM5MTQzMy4wLjAuMjEzODYzMDMwMA.." target="_blank" rel="noopener noreferrer">지수 백오프 정책</a>을 포함하여 <a href="https://developer.android.com/topic/libraries/architecture/workmanager/how-to/define-work?_gl=1*1ir6xg6*_up*MQ..*_ga*MTQ1MDI1MDM4NC4xNzM0MzkxNDMz*_ga_6HH9YJMN9M*MTczNDM5MTQzMy4xLjAuMTczNDM5MTQzMy4wLjAuMjEzODYzMDMwMA..#retries_backoff" target="_blank" rel="noopener noreferrer">유연한 재시도 정책</a>을 제공한다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="작업-체이닝">작업 체이닝<a href="#작업-체이닝" class="hash-link" aria-label="작업 체이닝에 대한 직접 링크" title="작업 체이닝에 대한 직접 링크">​</a></h4>
<p>복잡한 작업의 경우 직관적인 인터페이스를 사용하여 <a href="https://developer.android.com/topic/libraries/architecture/workmanager/how-to/chain-work?_gl=1*ipxv84*_up*MQ..*_ga*MTQ1MDI1MDM4NC4xNzM0MzkxNDMz*_ga_6HH9YJMN9M*MTczNDM5MTQzMy4xLjAuMTczNDM5MTQzMy4wLjAuMjEzODYzMDMwMA.." target="_blank" rel="noopener noreferrer">개별 작업을 연결</a>하여 어떤 작업이 순차적으로 실행되고 어떤 작업이 병렬로 실행될지 제어할 수 있다.</p>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Kotlin</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-kt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-kt codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> continuation </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> WorkManager</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getInstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">beginUniqueWork</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Constants</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">IMAGE_MANIPULATION_WORK_NAME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ExistingWorkPolicy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">REPLACE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    OneTimeWorkRequest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">from</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">CleanupWorker</span><span class="token operator" style="color:#393A34">::</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">java</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">OneTimeWorkRequest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">from</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">WaterColorFilterWorker</span><span class="token operator" style="color:#393A34">::</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">java</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">OneTimeWorkRequest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">from</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">GrayScaleFilterWorker</span><span class="token operator" style="color:#393A34">::</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">java</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">OneTimeWorkRequest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">from</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">BlurEffectFilterWorker</span><span class="token operator" style="color:#393A34">::</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">java</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">save</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        workRequest</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">SaveImageToGalleryWorker</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Constants</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TAG_OUTPUT</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* upload */</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        workRequest</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">UploadWorker</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Constants</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TAG_OUTPUT</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">WorkManager.getInstance(...)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .beginWith(Arrays.asList(workA, workB))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .then(workC)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .enqueue();</span><br></span></code></pre></div></div></div></div></div>
<p>각 작업 태스크에 대해 해당 작업에 대한 <a href="https://developer.android.com/topic/libraries/architecture/workmanager/how-to/define-work?_gl=1*mlerpu*_up*MQ..*_ga*MTQ1MDI1MDM4NC4xNzM0MzkxNDMz*_ga_6HH9YJMN9M*MTczNDM5MTQzMy4xLjAuMTczNDM5MTQzMy4wLjAuMjEzODYzMDMwMA..#input_output" target="_blank" rel="noopener noreferrer">입력 및 출력 데이터를 정의</a> 할 수 있다. 작업을 함께 연결할때 WorkManager는 자동으로 한 작업 목록에서 다음 작업 목록으로 출력 데이터를 전달한다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="내장된-상호-스레딩-운용">내장된 상호 스레딩 운용<a href="#내장된-상호-스레딩-운용" class="hash-link" aria-label="내장된 상호 스레딩 운용에 대한 직접 링크" title="내장된 상호 스레딩 운용에 대한 직접 링크">​</a></h4>
<p>WorkManager는 <a href="https://developer.android.com/topic/libraries/architecture/workmanager/advanced/coroutineworker?_gl=1*155py4x*_up*MQ..*_ga*MTQ1MDI1MDM4NC4xNzM0MzkxNDMz*_ga_6HH9YJMN9M*MTczNDM5MTQzMy4xLjAuMTczNDM5MTQzMy4wLjAuMjEzODYzMDMwMA.." target="_blank" rel="noopener noreferrer">Coroutines</a>과 <a href="https://developer.android.com/topic/libraries/architecture/workmanager/advanced/rxworker?_gl=1*1nq42mo*_up*MQ..*_ga*MTQ1MDI1MDM4NC4xNzM0MzkxNDMz*_ga_6HH9YJMN9M*MTczNDM5MTQzMy4xLjAuMTczNDM5MTQzMy4wLjAuMjEzODYzMDMwMA.." target="_blank" rel="noopener noreferrer">RxJava</a>와 <a href="https://developer.android.com/topic/libraries/architecture/workmanager/advanced/threading?_gl=1*1nq42mo*_up*MQ..*_ga*MTQ1MDI1MDM4NC4xNzM0MzkxNDMz*_ga_6HH9YJMN9M*MTczNDM5MTQzMy4xLjAuMTczNDM5MTQzMy4wLjAuMjEzODYzMDMwMA.." target="_blank" rel="noopener noreferrer">완벽하게 통합</a>되며, <a href="https://developer.android.com/topic/libraries/architecture/workmanager/advanced/listenableworker?_gl=1*1cyuof1*_up*MQ..*_ga*MTQ1MDI1MDM4NC4xNzM0MzkxNDMz*_ga_6HH9YJMN9M*MTczNDM5MTQzMy4xLjAuMTczNDM5MTQzMy4wLjAuMjEzODYzMDMwMA.." target="_blank" rel="noopener noreferrer">사용자의 비동기 API를 플러그인</a>할 수 있는 유연성을 제공한다.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>참고</div><div class="admonitionContent_BuS1"><p>코루틴과 WorkManager는 서로 다른 사용 사례에 권장되지만 상호 배타적이지는 않다. WorkManager를 통해 예약된 작업 내에서 코루틴을 사용할 수 있다.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="workmanager-시작하기">WorkManager 시작하기<a href="#workmanager-시작하기" class="hash-link" aria-label="WorkManager 시작하기에 대한 직접 링크" title="WorkManager 시작하기에 대한 직접 링크">​</a></h3>
<p>WorkManager를 사용하려면 먼저 라이브러리를 Android 프로젝트로 가져와야한다.</p>
<p>앱 <code>build.gradle</code> 파일에 다음 종속성을 추가하자.</p>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Groovy</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Kotlin</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-gradle codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gradle codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dependencies {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def work_version = &quot;2.9.1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // (Java only)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  implementation &quot;androidx.work:work-runtime:$work_version&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Kotlin + coroutines</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  implementation &quot;androidx.work:work-runtime-ktx:$work_version&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // optional - RxJava2 support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  implementation &quot;androidx.work:work-rxjava2:$work_version&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // optional - GCMNetworkManager support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  implementation &quot;androidx.work:work-gcm:$work_version&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // optional - Test helpers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  androidTestImplementation &quot;androidx.work:work-testing:$work_version&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // optional - Multiprocess support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  implementation &quot;androidx.work:work-multiprocess:$work_version&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-kt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-kt codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dependencies </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> work_version </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-literal singleline string" style="color:#e3116c">&quot;2.9.1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// (Java only)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">implementation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-literal singleline string" style="color:#e3116c">&quot;androidx.work:work-runtime:</span><span class="token string-literal singleline interpolation interpolation-punctuation punctuation" style="color:#393A34">$</span><span class="token string-literal singleline interpolation expression">work_version</span><span class="token string-literal singleline string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Kotlin + coroutines</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">implementation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-literal singleline string" style="color:#e3116c">&quot;androidx.work:work-runtime-ktx:</span><span class="token string-literal singleline interpolation interpolation-punctuation punctuation" style="color:#393A34">$</span><span class="token string-literal singleline interpolation expression">work_version</span><span class="token string-literal singleline string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// optional - RxJava2 support</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">implementation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-literal singleline string" style="color:#e3116c">&quot;androidx.work:work-rxjava2:</span><span class="token string-literal singleline interpolation interpolation-punctuation punctuation" style="color:#393A34">$</span><span class="token string-literal singleline interpolation expression">work_version</span><span class="token string-literal singleline string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// optional - GCMNetworkManager support</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">implementation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-literal singleline string" style="color:#e3116c">&quot;androidx.work:work-gcm:</span><span class="token string-literal singleline interpolation interpolation-punctuation punctuation" style="color:#393A34">$</span><span class="token string-literal singleline interpolation expression">work_version</span><span class="token string-literal singleline string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// optional - Test helpers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">androidTestImplementation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-literal singleline string" style="color:#e3116c">&quot;androidx.work:work-testing:</span><span class="token string-literal singleline interpolation interpolation-punctuation punctuation" style="color:#393A34">$</span><span class="token string-literal singleline interpolation expression">work_version</span><span class="token string-literal singleline string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// optional - Multiprocess support</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">implementation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-literal singleline string" style="color:#e3116c">&quot;androidx.work:work-multiprocess:</span><span class="token string-literal singleline interpolation interpolation-punctuation punctuation" style="color:#393A34">$</span><span class="token string-literal singleline interpolation expression">work_version</span><span class="token string-literal singleline string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div></div></div></div>
<p>종속성을 추가하고 Gradle 프로젝트를 동기화한 후 실행할 작업을 정의한다.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>참고</div><div class="admonitionContent_BuS1"><p>베타, 알파, 릴리스 후보 버전을 포함한 최신 버전의 WorkManager는 항상 <a href="https://developer.android.com/jetpack/androidx/releases/work?_gl=1*1wpnp38*_up*MQ..*_ga*MTQ1MDI1MDM4NC4xNzM0MzkxNDMz*_ga_6HH9YJMN9M*MTczNDM5MTQzMy4xLjAuMTczNDM5MTQzMy4wLjAuMjEzODYzMDMwMA.." target="_blank" rel="noopener noreferrer">WorkManager 릴리스 페이지</a> 에서 찾을 수 있다.</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="작업-정의하기">작업 정의하기<a href="#작업-정의하기" class="hash-link" aria-label="작업 정의하기에 대한 직접 링크" title="작업 정의하기에 대한 직접 링크">​</a></h4>
<p>작업은 <code>Worker</code>클래스를 사용하여 정의된다. <code>doWork()</code> 메서드는 WorkManager가 제공하는 백그라운드 스레드에서 비동기적으로 실행된다.</p>
<p>WorkManager가 실행할 작업을 만들려면 <code>Worker</code> 클래스를 확장하고 <code>doWork()</code>메서드를 재정의한다. 예를 들어 이미지를 업로드하는 <code>Worker</code>를 만들려면 다음과 같이 적용할 수 있다.</p>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Kotlin</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-kt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-kt codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">UploadWorker</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">appContext</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> workerParams</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> WorkerParameters</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token function" style="color:#d73a49">Worker</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">appContext</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> workerParams</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">override</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">fun</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">doWork</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Result </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// Do the work here--in this case, upload the images.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">uploadImages</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// Indicate whether the work finished successfully with the Result</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> Result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">success</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class UploadWorker extends Worker {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public UploadWorker(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      @NonNull Context context,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      @NonNull WorkerParameters params) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      super(context, params);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public Result doWork() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Do the work here--in this case, upload the images.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uploadImages();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Indicate whether the work finished successfully with the Result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return Result.success();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div></div></div></div>
<p><code>doWork()</code>를 통해 반환된 <code>Result</code> 내용은 WorkManager 서비스에 작업이 성공했는지 여부를 알려주고, 실패한 경우 작업을 다시 시도할지 여부를 알려준다.</p>
<ul>
<li><code>Result.success()</code>: 작업이 성공적으로 완료됨</li>
<li><code>Result.failure()</code>: 작업이 실패함</li>
<li><code>Result.retry()</code>: 작업이 실패하였으며, <strong>재시도 정책</strong>에 따라 다른 시간에 다시시도해야 함을 알림</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="작업-요청-생성">작업 요청 생성<a href="#작업-요청-생성" class="hash-link" aria-label="작업 요청 생성에 대한 직접 링크" title="작업 요청 생성에 대한 직접 링크">​</a></h4>
<p>작업이 정의되면 WorkManager 서비스로 예약해야 실행할 수 있다. WorkManager는 작업 예약 방법에 많은 유연성을 제공한다. 일정 시간 간격동안 <a href="https://developer.android.com/topic/libraries/architecture/workmanager/how-to/define-work?_gl=1*1wbm5nw*_up*MQ..*_ga*MTQ1MDI1MDM4NC4xNzM0MzkxNDMz*_ga_6HH9YJMN9M*MTczNDM5MTQzMy4xLjAuMTczNDM5MTQzMy4wLjAuMjEzODYzMDMwMA..#schedule_periodic_work" target="_blank" rel="noopener noreferrer">주기적으로 실행</a>되도록 예약하거나 <a href="https://developer.android.com/topic/libraries/architecture/workmanager/how-to/define-work?_gl=1*1wbm5nw*_up*MQ..*_ga*MTQ1MDI1MDM4NC4xNzM0MzkxNDMz*_ga_6HH9YJMN9M*MTczNDM5MTQzMy4xLjAuMTczNDM5MTQzMy4wLjAuMjEzODYzMDMwMA..#constraints" target="_blank" rel="noopener noreferrer">한 번만</a> 실행되도록 예약할 수 있다.</p>
<p>작업을 어떻게 예약하든 항상 <code>WorkRequest</code>를 사용한 다. <code>Worker</code>가 작업 단위를 정의한다면, <code>WorkRequest</code>(및 하위 클래스)는 실행 방법과 시기를 정의한다. 간단한 경우에는 아래와 같이 <code>OneTimeWorkRequest</code>를 사용할 수 있다.</p>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Kotlin</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-kt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-kt codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> uploadWorkRequest</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> WorkRequest </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  OneTimeWorkRequestBuilder</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">UploadWorker</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">build</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">WorkRequest uploadWorkRequest =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  new OneTimeWorkRequest.Builder(UploadWorker.class)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      .build();</span><br></span></code></pre></div></div></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="시스템에-workrequest-전달">시스템에 WorkRequest 전달<a href="#시스템에-workrequest-전달" class="hash-link" aria-label="시스템에 WorkRequest 전달에 대한 직접 링크" title="시스템에 WorkRequest 전달에 대한 직접 링크">​</a></h4>
<p>마지막으로, <code>WorkRequest</code>를 <code>WorkManager</code>로 <code>enqueue()</code>를 사용하여 제출해야 한다.</p>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Kotlin</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-kt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-kt codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">WorkManager</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getInstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">myContext</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">enqueue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uploadWorkRequest</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">WorkManager</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .getInstance(myContext)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .enqueue(uploadWorkRequest);</span><br></span></code></pre></div></div></div></div></div>
<p>워커가 실행되는 정확한 시간은 사용자가 정의한 <code>WorkRequest</code> 및 시스템 최적화에 사용되는 제약 조건에 따라 달라진다. WorkManager는 이러한 제약 조건하에서 최상의 동작을 제공하도록 설계되었다.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ios에서의-백그라운드-작업">iOS에서의 백그라운드 작업<a href="#ios에서의-백그라운드-작업" class="hash-link" aria-label="iOS에서의 백그라운드 작업에 대한 직접 링크" title="iOS에서의 백그라운드 작업에 대한 직접 링크">​</a></h2>
<p>안드로이드와 비교했을때, iOS에서는 백그라운드 작업에 많은 제한을 두고 있다. iOS 13 이전 버전에서는 백그라운드 프로세스로 동작하는 경우를 고려하지 않아, 많은 개발자들이 여러 방법으로 앱이 현재 &quot;실행 중&quot;인 것 처럼 속여서 프로그램을 동작시켜주는 방식을 많이 활용해왔다. iOS 13 이후 버전에서는 <em>앱이 현재 &quot;실행 중&quot;인 것 처럼 속여</em>서 실행하는 개념자체는 동일하지만 이러한 기능들을 더 쉽게 활용할 수 있도록 Bacground Tasks Framework를 제공해주고 있다.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="background-tasks">Background Tasks<a href="#background-tasks" class="hash-link" aria-label="Background Tasks에 대한 직접 링크" title="Background Tasks에 대한 직접 링크">​</a></h3>
<p>iOS 13부터 추가된 프레임워크로 시스템과 앱 간의 Background Task 요청을 담당하는 역할을 한다. 해당 프레임워크에서는 <code>BGAppRefreshTask</code>, <code>BGProcessingTask</code> 두 가지 타입을 제공해주는데 <code>BGAppRefreshTask</code>는 30초 정도가 소요되는 작업에 사용되고 그 이상의 시간이 소요되는 작업들은 <code>BGProcessingTask</code>를 사용하게 한다.</p>
<p><img decoding="async" loading="lazy" alt="ios background tasks run" src="/assets/images/ios_background_tasks_run-e5e3912d0cbbca3df86be4bbb1dfdd5b.png" width="1280" height="380" class="img_ev3q"></p>
<p><a href="https://developer.apple.com/videos/play/wwdc2019/707/?time=1149" target="_blank" rel="noopener noreferrer">WWDC 2019년 발표자료</a>를 참고해보면 사용자가 Foreground로 진입하는 시점을 시스템이 분석하여 Background Task를 먼저 실행해준다. 그 외에도 백그라운드 앱 새로고침 설정, 베터리 충전 상태, 네트워크 연결등의 속성을 추가해주어 호출하는 시점을 정해주며 이 부분은 시스템에서 자체적으로 적용하여 정확한 시점을 파악하기 힘들다.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="bgapprefreshtask">BGAppRefreshTask<a href="#bgapprefreshtask" class="hash-link" aria-label="BGAppRefreshTask에 대한 직접 링크" title="BGAppRefreshTask에 대한 직접 링크">​</a></h3>
<p><a href="https://developer.apple.com/videos/play/wwdc2019/707/?time=1131" target="_blank" rel="noopener noreferrer">WWDC 2019년 발표자료</a>를 확인해보면 <code>BGAppRefreshTask</code>에 대해 아래와 같이 설명한다.</p>
<p><img decoding="async" loading="lazy" alt="bgapprefreshtask_info" src="/assets/images/bgapprefreshtask_info-71488fe999c6ba9d04594d5bbeace94a.png" width="1570" height="796" class="img_ev3q"></p>
<p><code>BGAppRefreshTask</code>의 경우 30초 이내의 간단한 작업들에 사용되기 위해 만들어졌다. 또한 스케쥴러 속성을 설정하여 주기적으로 새로고침 작업을 실행해줄 수 있다.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="bgprocessingtask">BGProcessingTask<a href="#bgprocessingtask" class="hash-link" aria-label="BGProcessingTask에 대한 직접 링크" title="BGProcessingTask에 대한 직접 링크">​</a></h3>
<p><code>BGProcessingTask</code>의 경우 반대로 대용량 파일 다운로드나 데이터 동기화와 같이 시간이 많이 걸리는 작업을 수행하기 위해 만들어졌다.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="플러터에-연결하기">플러터에 연결하기<a href="#플러터에-연결하기" class="hash-link" aria-label="플러터에 연결하기에 대한 직접 링크" title="플러터에 연결하기에 대한 직접 링크">​</a></h2>
<p>하지만 위와 같  은 방법으로 프로그램을 동작하기 위해서는 결국 Kotlin, Swift 코드 모두 작성해야 한다. 단순히 백그라운드 작업을 추가해주기 위해 네이티브 언어로 작성하려고 보니 다트 코드보다 Kotlin, Swift 코드가 더 많아질 것 같다. 어떻게 좀 더 쉽게 적용할 수 있을까?</p>
<p>Flutter에서는 멀티 프로세스 환경에서도 코드를 실행해줄 수 있도록 Android/iOS 환경에서 각각 <a href="https://github.com/flutter/engine" target="_blank" rel="noopener noreferrer">FlutterEngine</a> 패키지를 제공해준다. 플러터 엔진은 플러터 애플리케이션을 호스팅하기 위한 휴대용 런타임 환경이다. 애니메이션 및 그래픽, 파일 및 네트워크 I/O, 접근성 지원, 플러그인 아키텍쳐, Dart 런타임 및 컴파일 툴체인 등 플러터의 핵심이 되는 기능들을 모두 구현할 수 있으며 이를 오픈소스로 제공해주고 있다.</p>
<p>따라서 FlutterEngine을 활용하여 Dart 코드를 받아와 백그라운드 프로세스에서 바로 실행될 수 있도록 적용한다면 보다 쉽게 백그라운드 작업을 적용할 수 있다.</p>
<p>아래에는 이러한 플러터엔진을 잘 활용한 <a href="https://pub.dev/packages/workmanager" target="_blank" rel="noopener noreferrer">flutter_workmanager</a> 패키지를 참고하여 개발한 내용을 정리하였다.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="코드로-작성하기">코드로 작성하기<a href="#코드로-작성하기" class="hash-link" aria-label="코드로 작성하기에 대한 직접 링크" title="코드로 작성하기에 대한 직접 링크">​</a></h3>
<p>플러터 코드에서 시작해 거꾸로 타고 들어가면서 코드를 확인해보자.</p>
<p>먼저 네이티브 코드에서 플러터 코드를 그대로 사용하기 위해 <code>@pragma(&#x27;vm:entry-point&#x27;)</code> 주석을 추가해준다. 이는 컴파일러에 해당 함수(또는 클래스와 같은 다  른 엔티티)가 <strong>네이티브 코드에서 사용될 것</strong>임을 나타낸다. 이 주석이 없으면 Dart 컴파일러는 최적화를 위해 사용하지 않는 함수를 제거하고, 인라인으로 만들거나, 이름을 축소하는 등 작업을 할 수 있으며 이 경우 네이티브 코드에서는 이를 호출하지 못할 수 있다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="main">Main<a href="#main" class="hash-link" aria-label="Main에 대한 직접 링크" title="Main에 대한 직접 링크">​</a></h4>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token metadata function" style="color:#d73a49">@pragma</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-literal string" style="color:#e3116c">&#x27;vm:entry-point&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Mandatory if the App is obfuscated or using Flutter 3.1+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">callbackDispatcher</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">BackgroundTask</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">executeTask</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">task</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> inputData</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">task</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><br></span></code></pre></div></div>
<p>위 코드와 같이 백그라운드 프로세싱을 위한 <code>BackgroundTask</code> 클래스를 선언해주고 Callback을 위한 <code>executeTask()</code> 함수에 비동기 함수를 전달한다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="backgroundtask">BackgroundTask<a href="#backgroundtask" class="hash-link" aria-label="BackgroundTask에 대한 직접 링크" title="BackgroundTask에 대한 직접 링크">​</a></h4>
<p><code>executeTask()</code>에서는 전달받은 함수를 <code>FlutterMethodCallHandler()</code>를 통해 네이티브 코드로 전달해준다.</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/// A helper function so you only need to implement a [BackgroundTaskHandler]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">executeTask</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">BackgroundTaskHandler</span><span class="token plain"> backgroundTask</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">WidgetsFlutterBinding</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ensureInitialized</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">DartPluginRegistrant</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ensureInitialized</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  _backgroundChannel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setMethodCallHandler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">call</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> inputData </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> call</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">arguments</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&quot;be.pinokiolab.workmanager.INPUT_DATA&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">backgroundTask</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      call</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">arguments</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-literal string" style="color:#e3116c">&quot;be.pinokiolab.workmanager.DART_TASK&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      inputData </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">jsonDecode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">inputData</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  _backgroundChannel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">invokeMethod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-literal string" style="color:#e3116c">&quot;backgroundChannelInitialized&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="native-code">Native Code<a href="#native-code" class="hash-link" aria-label="Native Code에 대한 직접 링크" title="Native Code에 대한 직접 링크">​</a></h4>
<p>MethodCall을 통해 Kotlin, Swift 코드를 실행해주면 각각의 클래스에 설정되어있던 FlutterEngine을 통해 Dart 코드를 실행해준다.</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>태그:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/flutter">flutter</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/i-os">iOS</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/swift">swift</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/android">android</a></li></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><a href="https://github.com/mooyeon-choi/mooyeon-choi.github.io/tree/master/blog/2024-12-12-how-to-run-application-on-background.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>페이지 편집</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="블로그 게시물 탐색"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/flutters-recommended-architecture-why-not-bloc"><div class="pagination-nav__sublabel">이전 게시물</div><div class="pagination-nav__label">Flutter 권장 아키텍쳐, BLoC은 왜 안될까?</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/ios-plugin-on-flutter"><div class="pagination-nav__sublabel">다음 게시물</div><div class="pagination-nav__label">Flutter에 iOS Swift 플러그인 만들기</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#소개" class="table-of-contents__link toc-highlight">소개</a></li><li><a href="#안드로이드에서의-백그라운드-작업" class="table-of-contents__link toc-highlight">안드로이드에서의 백그라운드 작업</a><ul><li><a href="#지속적인-작업의-유형" class="table-of-contents__link toc-highlight">지속적인 작업의 유형</a></li><li><a href="#workmanager-기능" class="table-of-contents__link toc-highlight">WorkManager 기능</a></li><li><a href="#workmanager-시작하기" class="table-of-contents__link toc-highlight">WorkManager 시  작하기</a></li></ul></li><li><a href="#ios에서의-백그라운드-작업" class="table-of-contents__link toc-highlight">iOS에서의 백그라운드 작업</a><ul><li><a href="#background-tasks" class="table-of-contents__link toc-highlight">Background Tasks</a></li><li><a href="#bgapprefreshtask" class="table-of-contents__link toc-highlight">BGAppRefreshTask</a></li><li><a href="#bgprocessingtask" class="table-of-contents__link toc-highlight">BGProcessingTask</a></li></ul></li><li><a href="#플러터에-연결하기" class="table-of-contents__link toc-highlight">플러터에 연결하기</a><ul><li><a href="#코드로-작성하기" class="table-of-contents__link toc-highlight">코드로 작성하기</a></li></ul></li></ul></div></div></div></div></div></div>
</body>
</html>